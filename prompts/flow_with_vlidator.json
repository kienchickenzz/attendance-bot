{
  "sequence": [
    {
      "id": "7974e50e072b48b916f976568a513781",
      "type": "session",
      "componentType": "task",
      "properties": {
        "extra": "{\n    \"company_name\": \"CMC TS\",\n    \"company_contact\": \"Hotline: 0899507188\",\n    \n    \"assistant_role\": \"Assistant named Minh Hiá»ƒn, specialized virtual assistant for comprehensive attendance and time management support. Assistant must always communicate in the User's preferred language and adapt to their communication style\",\n    \"assistant_skill\": \"Assistant is a knowledgeable specialist in attendance management systems, offering expert guidance on time tracking, work schedule optimization, and attendance policy compliance. Assistant excels at analyzing user attendance patterns, identifying potential issues, and providing actionable insights for improved time management. Assistant demonstrates proficiency in handling complex attendance calculations, comparative analysis, and generating meaningful reports. Assistant always responds in the language used by the User, adapting tone and complexity to match user preferences\",\n    \"assistant_scope\": \"Monitor and report real-time attendance status including check-in/check-out verification \\n- Analyze historical attendance data, calculate work hours, overtime, and attendance statistics \\n- Generate personalized attendance insights and recommendations\",\n    \"assistant_tone\": \"- Humor and sarcasm can be tricky in text. Let's keep the conversation straightforward and avoid misunderstandings\\n- Even in casual conversations, Assistant must maintain a level of professionalism. Let's keep the interaction respectful and professional.\",\n    \n    \"vn_pronoun\": \"Trong tiáº¿ng viá»‡t, Assistant luÃ´n lÃ  \\\"Em\\\" vÃ  Assistant PHáº¢I tá»± xÆ°ng lÃ  \\\"Em\\\" trong táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p. \\nAssistant gá»i User theo danh xÆ°ng lá»‹ch sá»± lÃ  \\\"anh\\\" náº¿u giá»›i tÃ­nh lÃ  NAM hoáº·c \\\"chá»‹\\\" náº¿u giá»›i tÃ­nh lÃ  Ná»® vÃ  náº¿u chÆ°a xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giá»›i tÃ­nh thÃ¬ gá»i User lÃ  \\\"anh/chá»‹\\\". \\n\\nXem cÃ¡c vÃ­ dá»¥ bÃªn dÆ°á»›i Ä‘á»ƒ hiá»ƒu rÃµ cÃ¡ch dÃ¹ng\\nUser: Xin chÃ o\\nReasoning: User nÃ³i xin chÃ o nhÆ°ng khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giá»›i tÃ­nh nÃªn Assistant sáº½ gá»i User lÃ  \\\"anh/chá»‹\\\", Assistant sáº½ lÃ  \\\"em\\\" \\nAssistant: Dáº¡, em cÃ³ thá»ƒ giÃºp gÃ¬ cho anh/chá»‹?\\n\\nUser: ChÃ o em, anh lÃ  TÃ¹ng, cho anh há»i má»™t chÃºt.\\nReasoning: User xÆ°ng \\\"anh\\\" vÃ  giá»›i thiá»‡u tÃªn lÃ  \\\"TÃ¹ng\\\" nÃªn xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giá»›i tÃ­nh lÃ  Nam nÃªn sáº½ gá»i User báº±ng danh xÆ°ng vÃ  tÃªn lÃ  \\\"Anh TÃ¹ng\\\". Assistant sáº½ lÃ  \\\"Em\\\"\\nAssistant: ChÃ o anh TÃ¹ng, em cÃ³ thá»ƒ giÃºp gÃ¬ cho anh.\",\n    \n    \"request_object\": {\n        \"user_name\":\"Nguyen Duc Kien\",\n        \"email\":\"duckien@gmail.com\",\n        \"time_info\": {\n            \"year\": 2025,\n            \"month\": 7,\n            \"day\": 14,\n            \"iso_weekday\": 1,\n            \"hour\": 8,\n            \"minute\": 38\n        }\n    }\n}"
      },
      "name": "Session Manager"
    },
    {
      "id": "040cbb402d38d3e6a7eea76162a38c6f",
      "type": "if",
      "componentType": "switch",
      "properties": {
        "condition": "session.recall_counter > 3"
      },
      "branches": {
        "true": [
          {
            "id": "13dd58e409027c5d3a1e757d979bdaab",
            "type": "setVar",
            "componentType": "task",
            "properties": {
              "varName": "session.recall_counter",
              "varValue": "0"
            },
            "name": "Var [session.recall_counter]"
          },
          {
            "id": "875fbf27694a010a89e63834b57b14f4",
            "type": "botSendText",
            "componentType": "task",
            "properties": {
              "text": "Dáº¡, em xin lá»—i, bÃªn em vá»«a gáº·p chÃºt váº¥n Ä‘á» vá»›i Ä‘Æ°á»ng truyá»n máº¡ng. Anh/chá»‹ gá»­i láº¡i thÃ´ng tin vá»«a rá»“i giÃºp em nhÃ©."
            },
            "name": "Bot Send Text"
          },
          {
            "id": "a523a82d67d20d06df6433e17e02bf92",
            "type": "clearTopic",
            "componentType": "task",
            "properties": {},
            "name": "Clear Topic"
          },
          {
            "id": "56ecbb1985c0dc4559b03bd6f8874c2f",
            "type": "break",
            "componentType": "task",
            "properties": {},
            "name": "Break"
          }
        ],
        "false": []
      },
      "name": "Recall counters exceeded?"
    },
    {
      "id": "10bc708dba622d91344d962b1458cc92",
      "type": "python",
      "componentType": "task",
      "properties": {
        "varName": "user_id",
        "expression": "def get_user_input( input ):\n    user_id, user_question = input.split( \"|\", 1 )\n    return user_id\n\nhuman_input = \"{{ human_input }}\"\nprint( get_user_input( human_input ) )"
      },
      "name": "Python"
    },
    {
      "id": "6cb8a7e5315c62396f00dbf698b02ca7",
      "type": "python",
      "componentType": "task",
      "properties": {
        "varName": "user_input",
        "expression": "def get_user_input( input ):\n    user_id, user_input = input.split( \"|\", 1 )\n    return user_input\n\nhuman_input = \"{{ human_input }}\"\nprint( get_user_input( human_input ) )"
      },
      "name": "Python"
    },
    {
      "id": "acd26cd265b849c20f82db09a87f5bf6",
      "type": "router",
      "componentType": "task",
      "properties": {
        "setting": [
          {
            "topic": "greetings",
            "phrases": [
              "hello",
              "hi",
              "chÃ o báº¡n",
              "xin chÃ o",
              "cÃ³ ai á»Ÿ Ä‘Ã¢y khÃ´ng"
            ],
            "keywords": [
              "hello",
              "hi",
              "chÃ o báº¡n",
              "xin chÃ o",
              "cÃ³ ai á»Ÿ Ä‘Ã¢y khÃ´ng"
            ]
          },
          {
            "topic": "attendance",
            "phrases": [
              "check-in",
              "check in",
              "check-out",
              "check out",
              "cháº¥m cÃ´ng",
              "vÃ o lÃ m",
              "giá» vÃ o",
              "giá» ra",
              "thá»i gian vÃ o",
              "thá»i gian ra",
              "Ä‘i muá»™n",
              "ngÃ y cÃ´ng",
              "Ä‘Æ°á»£c tÃ­nh ngÃ y cÃ´ng",
              "Ä‘i lÃ m Ä‘áº§y Ä‘á»§",
              "bá»‹ trá»« cÃ´ng",
              "vi pháº¡m",
              "Ä‘i muá»™n",
              "vá» muá»™n",
              "vá» sá»›m",
              "khÃ´ng Ä‘á»§ cÃ´ng",
              "bá»‹ trá»« giá»",
              "bá»‹ trá»« cÃ´ng",
              "Ä‘i trá»…",
              "hÃ´m nay",
              "hÃ´m qua",
              "hÃ´m trÆ°á»›c",
              "hÃ´m kia",
              "ngÃ y X (cá»¥ thá»ƒ: 10/7, 1/8, 10, 12, 15, v.v.)",
              "thá»© X (thá»© 2, thá»© 3, thá»© 4, thá»© 5, thá»© 7, v.v.)",
              "tuáº§n nÃ y",
              "tuáº§n trÆ°á»›c",
              "tuáº§n trÆ°á»›c ná»¯a",
              "tuáº§n vá»«a rá»“i",
              "thÃ¡ng nÃ y",
              "thÃ¡ng vá»«a rá»“i",
              "thÃ¡ng trÆ°á»›c",
              "Ä‘áº§u tuáº§n",
              "Ä‘áº§u thÃ¡ng",
              "tá»« ngÃ y X Ä‘áº¿n ngÃ y Y",
              "tÃ´i Ä‘Ã£ â€¦ chÆ°a",
              "tÃ´i â€¦ lÃºc nÃ o",
              "lÃ  lÃºc nÃ o",
              "thÃ¬ sao",
              "tháº¿ nÃ o",
              "trong khoáº£ng thá»i gian Ä‘Ã³",
              "ÄÃ³ lÃ  nhá»¯ng ngÃ y nÃ o?"
            ],
            "keywords": [
              "check-in",
              "check in",
              "check-out",
              "check out",
              "cháº¥m cÃ´ng",
              "vÃ o lÃ m",
              "giá» vÃ o",
              "giá» ra",
              "thá»i gian vÃ o",
              "thá»i gian ra",
              "Ä‘i muá»™n",
              "ngÃ y cÃ´ng",
              "Ä‘Æ°á»£c tÃ­nh ngÃ y cÃ´ng",
              "Ä‘i lÃ m Ä‘áº§y Ä‘á»§",
              "bá»‹ trá»« cÃ´ng",
              "vi pháº¡m",
              "Ä‘i muá»™n",
              "vá» muá»™n",
              "vá» sá»›m",
              "khÃ´ng Ä‘á»§ cÃ´ng",
              "bá»‹ trá»« giá»",
              "bá»‹ trá»« cÃ´ng",
              "Ä‘i trá»…",
              "hÃ´m nay",
              "hÃ´m qua",
              "hÃ´m trÆ°á»›c",
              "hÃ´m kia",
              "ngÃ y X (cá»¥ thá»ƒ: 10/7, 1/8, 10, 12, 15, v.v.)",
              "thá»© X (thá»© 2, thá»© 3, thá»© 4, thá»© 5, thá»© 7, v.v.)",
              "tuáº§n nÃ y",
              "tuáº§n trÆ°á»›c",
              "tuáº§n trÆ°á»›c ná»¯a",
              "tuáº§n vá»«a rá»“i",
              "thÃ¡ng nÃ y",
              "thÃ¡ng vá»«a rá»“i",
              "thÃ¡ng trÆ°á»›c",
              "Ä‘áº§u tuáº§n",
              "Ä‘áº§u thÃ¡ng",
              "tá»« ngÃ y X Ä‘áº¿n ngÃ y Y",
              "tÃ´i Ä‘Ã£ â€¦ chÆ°a",
              "tÃ´i â€¦ lÃºc nÃ o",
              "lÃ  lÃºc nÃ o",
              "thÃ¬ sao",
              "tháº¿ nÃ o",
              "trong khoáº£ng thá»i gian Ä‘Ã³",
              "giá» cÃ´ng",
              "ngÃ y cÃ´ng"
            ]
          },
          {
            "topic": "off_topic",
            "phrases": [
              "lÃ m thÆ¡",
              "viáº¿t code"
            ],
            "keywords": [
              "lÃ m thÆ¡",
              "viáº¿t code"
            ]
          }
        ]
      },
      "name": "Router"
    },
    {
      "id": "b11ef36f209327bd8fe76de7a1e3629a",
      "type": "flowSwitch",
      "componentType": "switch",
      "properties": {
        "conditions": {
          "greetings": "greetings",
          "off_topic": "off_topic",
          "attendance": "attendance"
        }
      },
      "branches": {
        "greetings": [
          {
            "id": "d33e8281a8ae7b05b54ded0fe85b75db",
            "type": "botSendText",
            "componentType": "task",
            "properties": {
              "text": "ChÃ o anh/chá»‹ ðŸ‘‹ Em lÃ  Minh Hiá»ƒn â€” trá»£ lÃ½ áº£o há»— trá»£ tra cá»©u thÃ´ng tin cháº¥m cÃ´ng cho cÃ´ng ty.\nEm cÃ³ thá»ƒ giÃºp anh/chá»‹ tra cá»©u thá»i gian lÃ m viá»‡c, tráº¡ng thÃ¡i check-in/check-out.\nVÃ­ dá»¥, anh/chá»‹ cÃ³ thá»ƒ há»i:\n- \"Thá»i gian check in, check out hÃ´m qua\"\n- \"HÃ´m qua tÃ´i cÃ³ Ä‘i muá»™n khÃ´ng?\"\n- \"HÃ´m trÆ°á»›c tÃ´i Ä‘Æ°á»£c tÃ­nh bao nhiÃªu ngÃ y cÃ´ng?\"\n- \"Tá»•ng thá»i gian vi pháº¡m cá»§a tÃ´i hÃ´m nay?\"\nHÃ´m nay anh/chá»‹ muá»‘n tra cá»©u thÃ´ng tin gÃ¬ áº¡?"
            },
            "name": "Bot Send Text"
          },
          {
            "id": "6d174a7d6a49713a3aca4f6dee7b567a",
            "type": "clearTopic",
            "componentType": "task",
            "properties": {},
            "name": "Clear Topic"
          }
        ],
        "off_topic": [
          {
            "id": "e9dc59fd932a7c7554bc9551f030137c",
            "type": "botSendText",
            "componentType": "task",
            "properties": {
              "text": "Xin lá»—i, em khÃ´ng thá»ƒ tráº£ lá»i cÃ¢u há»i cá»§a anh/chá»‹."
            },
            "name": "Bot Send Text"
          },
          {
            "id": "1482f59b6d490c4c742ffb7384ed9d76",
            "type": "clearTopic",
            "componentType": "task",
            "properties": {},
            "name": "Clear Topic"
          }
        ],
        "attendance": [
          {
            "id": "dd0378f6e848991df0759b8fc8a5338e",
            "type": "botAPICall",
            "componentType": "task",
            "properties": {
              "api_response_var_name": "api_session_info",
              "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/session/{{ user_id }}",
              "api_body": "",
              "api_header": "{\n    \"Content-Type\": \"application/json\"\n}",
              "api_method": "GET"
            },
            "name": "Bot API Call"
          },
          {
            "id": "dc1b3c1c5ae04140a526290729f9ef92",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "current_time",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field( session_obj):\n    return session_obj[ \"data\" ][ \"current_time\" ]\n\nprint( get_session_field( session_obj ) )"
            },
            "name": "Python"
          },
          {
            "id": "b8b47536bb08e8854da9dcb2261177cf",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "user_name",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field( session_obj):\n    return session_obj[ \"data\" ][ \"user_name\" ]\n\nprint( get_session_field( session_obj ) )"
            },
            "name": "Python"
          },
          {
            "id": "0d16a10992103e0b4e99d66b926c9971",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "user_email",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field( session_obj):\n    return session_obj[ \"data\" ][ \"user_email\" ]\n\nprint( get_session_field( session_obj ) )"
            },
            "name": "Python"
          },
          {
            "id": "dc1ccd87e2269a7b85e02bbc865aa7e8",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "time_query",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field( session_obj):\n\n    return session_obj[ \"data\" ].get( \"time_query\", \"KhÃ´ng cÃ³\" )\n\nprint( get_session_field( session_obj ) )"
            },
            "name": "Python"
          },
          {
            "id": "65e080718663161d783e918deeba60db",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "time_query_in_string",
              "expression": "session_obj = {{ api_session_info }}\n\ntime_query = session_obj[\"data\"].get( \"time_query\", None )\n\nif not time_query:  # None hoáº·c []\n    result_string = \"KhÃ´ng cÃ³\"\nelse:\n    # Táº¡o chuá»—i káº¿t quáº£ trá»±c tiáº¿p tá»« list cÃ¡c dict/TimePeriod\n    lines = [\n        f\"NgÃ y báº¯t Ä‘áº§u {index + 1}: {item.get('start_date', 'N/A')}\\n\"\n        f\"NgÃ y káº¿t thÃºc {index + 1}: {item.get('end_date', 'N/A')}\"\n        for index, item in enumerate(time_query)\n    ]\n    result_string = \"\\n\".join(lines)\n\nprint(result_string)\n"
            },
            "name": "Python"
          },
          {
            "id": "c0312f36805ce10bba94df22916cbb59",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "current_topic",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field(session_obj):\n    topic = session_obj[\"data\"].get(\"topic\")\n    return topic if topic is not None else \"KhÃ´ng cÃ³\"\n\nprint(get_session_field(session_obj))\n"
            },
            "name": "Python"
          },
          {
            "id": "07f205ffa7658a87fbf8e6198bab07be",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "prev_question",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field(session_obj):\n    prev_question = session_obj[\"data\"].get(\"prev_question\")\n    return prev_question if prev_question is not None else \"KhÃ´ng cÃ³\"\n\nprint(get_session_field(session_obj))\n"
            },
            "name": "Python"
          },
          {
            "id": "738f64929ac7cb219f682ab83d9a87ed",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "prev_answer",
              "expression": "session_obj = {{ api_session_info }}\n\ndef get_session_field(session_obj):\n    prev_answer = session_obj[\"data\"].get(\"prev_answer\")\n    return prev_answer if prev_answer is not None else \"KhÃ´ng cÃ³\"\n\nprint(get_session_field(session_obj))\n"
            },
            "name": "Python"
          },
          {
            "id": "da014f6068714de6cd47384c4ec52153",
            "type": "qna",
            "componentType": "task",
            "properties": {
              "instruction": "Dá»±a vÃ o ngá»¯ cáº£nh hiá»‡n táº¡i, hÃ£y phÃ¢n tÃ­ch cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng Ä‘á»ƒ Ä‘Æ°a ra pháº£n há»“i phÃ¹ há»£p.\n\nNgá»¯ cáº£nh hiá»‡n táº¡i:\n- NgÃ y hiá»‡n táº¡i: {{ current_time }}\n- Khoáº£ng thá»i gian mÃ  ngÆ°á»i dÃ¹ng Ä‘ang nháº¯c Ä‘áº¿n:\n{{ time_query_in_string }}\n- Chá»§ Ä‘á» mÃ  ngÆ°á»i dÃ¹ng Ä‘ang nháº¯c Ä‘áº¿n: {{ current_topic }}\n- CÃ¢u há»i trÆ°á»›c Ä‘Ã³ cá»§a ngÆ°á»i dÃ¹ng: {{ prev_question }}\n- CÃ¢u tráº£ lá»i cho cÃ¢u há»i trÆ°á»›c Ä‘Ã³: \n{{ prev_answer }}\n- LÆ°u Ã½:\n    - Cáº·p cÃ¢u há»i vÃ  cÃ¢u tráº£ lá»i trÆ°á»›c Ä‘Ã³ chá»‰ mang tÃ­nh cháº¥t tham kháº£o vÃ  chá»‰ sá»­ dá»¥ng náº¿u cÃ¢u há»i hiá»‡n táº¡i yÃªu cáº§u liÃªn káº¿t vá»›i má»‘c thá»i gian Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» cáº­p trong cÃ¢u trÆ°á»›c.\n    - VÃ­ dá»¥:\n        - CÃ¢u 1: â€œTuáº§n vá»«a rá»“i cÃ³ hÃ´m nÃ o tÃ´i Ä‘i muá»™n khÃ´ng?â€\n        - CÃ¢u 2: â€œThá»i gian check in nhá»¯ng ngÃ y Ä‘Ã³?â€\n        â†’ á»ž cÃ¢u 2, cáº§n láº¥y má»‘c thá»i gian tá»« cÃ¢u tráº£ lá»i cá»§a cÃ¢u 1 (â€œnhá»¯ng ngÃ y Ä‘Ã³â€ = cÃ¡c ngÃ y Ä‘i muá»™n trong tuáº§n vá»«a rá»“i) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c khoáº£ng thá»i gian.\n\nCÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng: {{ user_input }}\n\nQuy táº¯c xá»­ lÃ­ tuáº§n tá»±: (Pháº£i thá»±c hiá»‡n tuáº§n tá»± cÃ¡c bÆ°á»›c tá»« 1 Ä‘áº¿n 7, khÃ´ng Ä‘Æ°á»£c bá» qua hoáº·c hoÃ¡n Ä‘á»•i thá»© tá»±. Chá»‰ khi hoÃ n táº¥t bÆ°á»›c trÆ°á»›c Ä‘Ã³ thÃ¬ má»›i Ä‘Æ°á»£c chuyá»ƒn sang bÆ°á»›c tiáº¿p theo.)\n\n1. Nháº­n diá»‡n thÃ´ng tin thá»i gian trong cÃ¢u há»i\n- Náº¿u ngÆ°á»i dÃ¹ng cÃ³ Ä‘á» cáº­p Ä‘áº¿n thÃ´ng tin thá»i gian bao gá»“m ngÃ y, thÃ¡ng, nÄƒm, tuáº§n, hoáº·c cÃ¡c tá»« khÃ³a chá»‰ má»‘c thá»i gian cá»¥ thá»ƒ hoáº·c tÆ°Æ¡ng Ä‘á»‘i nhÆ°:\n    - â€œhÃ´m nayâ€, â€œngÃ y maiâ€, â€œhÃ´m quaâ€\n    - â€œtuáº§n nÃ yâ€, â€œthÃ¡ng trÆ°á»›câ€, â€œquÃ½ nÃ yâ€\n    - â€œngÃ y 1/8â€, â€œthÃ¡ng 7â€, â€œnÄƒm 2025â€\n    - â€œlÃºc 8 giá»â€, â€œ9h sÃ¡ngâ€, â€œchiá»u nayâ€\n    - â€œtrong 3 ngÃ y gáº§n Ä‘Ã¢yâ€, â€œ7 ngÃ y quaâ€, â€œcuá»‘i tuáº§nâ€\nthÃ¬ xÃ¡c Ä‘á»‹nh CÃ³ Ä‘á» cáº­p Ä‘áº¿n thá»i gian vÃ  chuyá»ƒn sang **BÆ°á»›c 2**\n- Náº¿u ngÆ°á»i dÃ¹ng khÃ´ng Ä‘á» cáº­p Ä‘áº¿n báº¥t ká»³ thÃ´ng tin thá»i gian nÃ o (tá»©c lÃ  cÃ¢u há»i khÃ´ng chá»©a ngÃ y, thÃ¡ng, nÄƒm, tuáº§n, hoáº·c cÃ¡c tá»« khÃ³a chá»‰ má»‘c thá»i gian cá»¥ thá»ƒ/tÆ°Æ¡ng Ä‘á»‘i nhÆ° trÃªn), thÃ¬ xÃ¡c Ä‘á»‹nh lÃ  KhÃ´ng Ä‘á» cáº­p Ä‘áº¿n thá»i gian vÃ  chuyá»ƒn sang **BÆ°á»›c 4**.\n    - Quy táº¯c nÃ y Ã¡p dá»¥ng cho má»i loáº¡i cÃ¢u há»i (check-in, check-out, vi pháº¡m, ngÃ y cÃ´ng, â€¦). Chá»‰ cáº§n khÃ´ng xuáº¥t hiá»‡n thÃ´ng tin thá»i gian, coi nhÆ° KhÃ´ng cÃ³ thá»i gian.\n- NgoÃ i ra, náº¿u cÃ¢u há»i cÃ³ chá»©a cÃ¡c tá»« khÃ³a chá»‰ thá»i gian mÆ¡ há»“, khÃ´ng xÃ¡c Ä‘á»‹nh rÃµ rÃ ng nhÆ°:\n    - â€œhÃ´m áº¥yâ€, â€œhÃ´m Ä‘áº¥yâ€, â€œhÃ´m Ä‘Ã³â€, â€œngÃ y hÃ´m Ä‘Ã³â€\n    - â€œtuáº§n Ä‘áº¥yâ€, â€œthÃ¡ng Ä‘áº¥yâ€, â€œthÃ¡ng Ä‘Ã³â€\n    - \"nhá»¯ng ngÃ y Ä‘Ã³\", \"nhá»¯ng hÃ´m Ä‘áº¥y\", \"nhá»¯ng hÃ´m áº¥y\"\nhoáº·c cÃ¡c biáº¿n thá»ƒ tÆ°Æ¡ng tá»±: â€œlÃºc Ä‘Ã³â€, â€œdáº¡o áº¥yâ€, â€œthá»i Ä‘iá»ƒm áº¥yâ€\nthÃ¬ cÅ©ng xÃ¡c Ä‘á»‹nh lÃ  KhÃ´ng Ä‘á» cáº­p Ä‘áº¿n thá»i gian vÃ  chuyá»ƒn sang **BÆ°á»›c 4**\n\n2. XÃ¡c Ä‘á»‹nh loáº¡i thá»i gian trong cÃ¢u há»i\n- Má»™t ngÃ y cá»¥ thá»ƒ (1 cáº·p start_date, end_date vá»›i start_date = end_date). \n    - VÃ­ dá»¥:\n        - HÃ´m nay tÃ´i check-in chÆ°a?\n        - NgÃ y 10 thÃ¡ng 7 tÃ´i vÃ o lÃ m máº¥y giá»?\n        - TÃ´i cÃ³ quÃªn cháº¥m cÃ´ng hÃ´m qua khÃ´ng?\n        - Giá» check out hÃ´m kia lÃ  lÃºc nÃ o?\n        - Thá»© 3 tuáº§n trÆ°á»›c tÃ´i check in lÃºc nÃ o?\n        - Thá»© 5 tuáº§n trÆ°á»›c ná»¯a tÃ´i check out máº¥y giá»?\nhoáº·c cÃ³ chá»©a cÃ¡c cá»¥m tá»« gá»£i Ã½ má»™t ngÃ y cá»¥ thá»ƒ, nhÆ°: \"hÃ´m nay\", \"hÃ´m qua\", \"hÃ´m kia\", \"hÃ´m trÆ°á»›c\", \"ngÃ y [sá»‘]\", \"ngÃ y [sá»‘] thÃ¡ng [sá»‘]\", \"thá»© 2 tuáº§n trÆ°á»›c\", \"thá»© 6 vá»«a rá»“i\", \"thá»© 4 tuáº§n nÃ y\", \"thá»© 3 vá»«a qua\" v.v.\n- Má»™t khoáº£ng thá»i gian cá»¥ thá»ƒ (1 cáº·p start_date, end_date vá»›i start_date khÃ¡c end_date). \n    - VÃ­ dá»¥:\n        - â€œTrong thÃ¡ng 6 tÃ´i Ä‘i lÃ m máº¥y giá» má»—i ngÃ y?â€\n        - â€œTá»« ngÃ y 3/8 Ä‘áº¿n 18/8 tÃ´i cÃ³ Ä‘i lÃ m Ä‘áº§y Ä‘á»§ khÃ´ng?â€\n        - Trong thÃ¡ng 6 tÃ´i Ä‘i lÃ m máº¥y giá» má»—i ngÃ y?\n        - Thá»i gian check-in cá»§a tÃ´i tuáº§n vá»«a rá»“i?\n        - CÃ³ ngÃ y nÃ o trong 2 tuáº§n vá»«a rá»“i tÃ´i quÃªn cháº¥m cÃ´ng khÃ´ng?\n        - Tá»« ngÃ y 3/8 Ä‘áº¿n 18/8 tÃ´i cÃ³ Ä‘i lÃ m Ä‘áº§y Ä‘á»§ khÃ´ng?\nhoáº·c chá»©a cÃ¡c cá»¥m tá»« thá»ƒ hiá»‡n khoáº£ng thá»i gian, nhÆ°: â€œtrong tuáº§n trÆ°á»›câ€, â€œtrong thÃ¡ng nÃ yâ€, â€œ2 tuáº§n vá»«a rá»“iâ€, \"tuáº§n vá»«a rá»“i\", \"tuáº§n vá»«a qua\", â€œtá»« ngÃ y ... Ä‘áº¿n ngÃ y ...â€, â€œtá»« thá»© 2 Ä‘áº¿n thá»© 6â€, â€œtá»« Ä‘áº§u tuáº§n Ä‘áº¿n nayâ€, â€œtá»« Ä‘áº§u tuáº§n nÃ y Ä‘áº¿n nayâ€, â€œtá»« Ä‘áº§u tuáº§n trÆ°á»›c Ä‘áº¿n nayâ€, â€œtá»« Ä‘áº§u tuáº§n vá»«a rá»“i Ä‘áº¿n nayâ€, v.v.\n- Nhiá»u khoáº£ng/má»‘c thá»i gian cá»¥ thá»ƒ (nhiá»u cáº·p start_date, end_date). \n    - Khi trong cÃ¢u há»i xuáº¥t hiá»‡n tá»« 2 má»‘c trá»Ÿ lÃªn hoáº·c nhiá»u khoáº£ng thá»i gian Ä‘Æ°á»£c ná»‘i báº±ng cÃ¡c tá»« liÃªn káº¿t nhÆ° â€œvÃ â€, â€œhoáº·câ€, â€œcÅ©ng nhÆ°â€.\n    - VÃ­ dá»¥:\n        - CÃ¢u \"MÃ¹ng 10, 12, 15 thÃ¡ng trÆ°á»›c tÃ´i check in lÃºc nÃ o?\" cÃ³ 3 ngÃ y cá»¥ thá»ƒ\n        - CÃ¢u \"CÃ¡c ngÃ y 10, 12, 15 cá»§a thÃ¡ng vá»«a rá»“i tÃ´i cÃ³ Ä‘i muá»™n khÃ´ng?\" cÃ³ 3 ngÃ y cá»¥ thá»ƒ\n        - CÃ¢u \"NgÃ y 10, 12, 15 thÃ¡ng vá»«a qua tÃ´i cÃ³ Ä‘Æ°á»£c tÃ­nh Ä‘á»§ ngÃ y cÃ´ng khÃ´ng?\" cÃ³ 3 ngÃ y cá»¥ thá»ƒ\n        - CÃ¢u \"Tá»« ngÃ y 1 Ä‘áº¿n 5 vÃ  tá»« ngÃ y 10 Ä‘áº¿n 12 tÃ´i cÃ³ Ä‘i lÃ m Ä‘áº§y Ä‘á»§ khÃ´ng\" cÃ³ 2 khoáº£ng thá»i gian cá»¥ thá»ƒ\n    - LÆ°u Ã½: Vá»›i má»—i khoáº£ng/má»‘c thá»i gian, cáº§n láº·p láº¡i **BÆ°á»›c 3 - TÃ­nh khoáº£ng thá»i gian** Ä‘á»ƒ tÃ­nh start_date vÃ  end_date riÃªng.\n- Sau khi xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c loáº¡i thá»i gian thÃ¬ chuyá»ƒn sang **BÆ°á»›c 3**\n\n3. TÃ­nh khoáº£ng thá»i gian\n- Cho 1 ngÃ y cá»¥ thá»ƒ\n    - Nháº­n diá»‡n cÃ¡c cá»¥m tá»« mÃ´ táº£ ngÃ y cá»¥ thá»ƒ, bao gá»“m:\n        - \"hÃ´m qua\", \"hÃ´m nay\", \"hÃ´m trÆ°á»›c\", \"hÃ´m kia\", \"hÃ´m kÃ¬a\"\n        - \"ngÃ y 5\", \"mÃ¹ng 3\"\n        - \"thá»© 2\", \"thá»© ba tuáº§n trÆ°á»›c\", \"thá»© nÄƒm tuáº§n nÃ y\"\n        - \"ngÃ y 15 thÃ¡ng 6\", \"ngÃ y 2 thÃ¡ng trÆ°á»›c\", v.v.\n    - Giáº£i thÃ­ch cÃ¡c cá»¥m thá»i gian tÆ°Æ¡ng Ä‘á»‘i dá»±a trÃªn current_date:\n        - â€œhÃ´m nayâ€ â†’ chÃ­nh lÃ  current_date\n        - â€œhÃ´m quaâ€ â†’ current_date - 1 ngÃ y\n        - â€œhÃ´m trÆ°á»›câ€ â†’ current_date - 2 ngÃ y\n        - â€œhÃ´m kiaâ€ â†’ current_date - 2 ngÃ y\n        - â€œhÃ´m kÃ¬aâ€ â†’ current_date - 3 ngÃ y\n        - â€œthá»© [x] tuáº§n nÃ yâ€ â†’ ngÃ y gáº§n nháº¥t á»©ng vá»›i thá»© Ä‘Ã³ trong cÃ¹ng tuáº§n vá»›i current_date\n        - â€œthá»© [x] tuáº§n trÆ°á»›câ€ â†’ ngÃ y tÆ°Æ¡ng á»©ng vá»›i thá»© Ä‘Ã³ cá»§a tuáº§n trÆ°á»›c (tuáº§n gáº§n nháº¥t Ä‘Ã£ káº¿t thÃºc)\n        - â€œngÃ y [sá»‘]â€ hoáº·c â€œmÃ¹ng [sá»‘]â€ â†’ cÃ¹ng thÃ¡ng vá»›i current_date\n        - â€œngÃ y [sá»‘] thÃ¡ng [sá»‘]â€ â†’ sá»­ dá»¥ng nÄƒm cá»§a current_date, trá»« khi ngÆ°á»i dÃ¹ng nÃ³i rÃµ nÄƒm\n        - â€œngÃ y [sá»‘] thÃ¡ng trÆ°á»›câ€ â†’ ngÃ y tÆ°Æ¡ng á»©ng cá»§a thÃ¡ng trÆ°á»›c\n        - â€œngÃ y [sá»‘] thÃ¡ng nÃ yâ€ â†’ ngÃ y tÆ°Æ¡ng á»©ng cá»§a thÃ¡ng hiá»‡n táº¡i\n    - VÃ­ dá»¥:\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: â€œTÃ´i check in hÃ´m qua lÃºc máº¥y giá»?â€ thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : current_time: \"2025-03-07\"\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i: â€œNgÃ y 2 thÃ¡ng trÆ°á»›c tÃ´i nghá»‰ phÃ©pâ€ thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : current_time: \"2025-02-02\"\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i: â€œThá»© ba tuáº§n nÃ y tÃ´i Ä‘áº¿n trá»…â€ thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : current_time: \"2025-03-04\"\n- Cho 1 khoáº£ng thá»i gian\n    - Nháº­n diá»‡n cÃ¡c cá»¥m tá»« chá»‰ khoáº£ng thá»i gian nhÆ°:\n        - â€œtá»« [ngÃ y/thÃ¡ng/thá»©] ... Ä‘áº¿n [ngÃ y/thÃ¡ng/thá»©]â€\n        - â€œtá»« ngÃ y ... Ä‘áº¿n ngÃ y ...â€\n    - Giáº£i thÃ­ch tÆ°Æ¡ng Ä‘á»‘i cÃ¡c cá»¥m thá»i gian báº±ng cÃ¡ch dá»±a trÃªn ngÃ y hiá»‡n táº¡i (theo Ä‘á»‹nh dáº¡ng YYYY-MM-DD).\n        - Náº¿u ngÆ°á»i dÃ¹ng chá»‰ nÃ³i \"tá»« mÃ¹ng 1 Ä‘áº¿n mÃ¹ng 6\", hiá»ƒu lÃ  cÃ¹ng thÃ¡ng vá»›i ngÃ y hiá»‡n táº¡i (vÃ­ dá»¥: náº¿u ngÃ y hiá»‡n táº¡i lÃ  2025-03-08 -> khoáº£ng thá»i gian lÃ  2025-03-01 Ä‘áº¿n 2025-03-06)\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i \"tá»« thá»© 3 tuáº§n trÆ°á»›c Ä‘áº¿n thá»© 3 tuáº§n nÃ y\", sá»­ dá»¥ng logic tÃ­nh toÃ¡n tuáº§n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘Ãºng cÃ¡c ngÃ y tÆ°Æ¡ng á»©ng\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i \"tá»« 15 thÃ¡ng trÆ°á»›c Ä‘áº¿n 15 thÃ¡ng nÃ y\", láº¥y ngÃ y 15 cá»§a thÃ¡ng trÆ°á»›c vÃ  thÃ¡ng hiá»‡n táº¡i dá»±a trÃªn current_date\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i \"tuáº§n vá»«a rá»“i\", \"tuáº§n trÆ°á»›c\" hoáº·c \"tuáº§n vá»«a qua\", hiá»ƒu lÃ  tá»« thá»© 2 Ä‘áº¿n thá»© 6 cá»§a tuáº§n gáº§n nháº¥t Ä‘Ã£ káº¿t thÃºc\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i \"2 tuáº§n vá»«a rá»“i\" hoáº·c \"2 tuáº§n qua\", hiá»ƒu lÃ  tá»« thá»© 2 cá»§a 2 tuáº§n trÆ°á»›c Ä‘áº¿n thá»© 6 cá»§a tuáº§n gáº§n nháº¥t Ä‘Ã£ káº¿t thÃºc\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i â€œtá»« Ä‘áº§u tuáº§n Ä‘áº¿n nayâ€ hoáº·c â€œtá»« Ä‘áº§u tuáº§n nÃ y Ä‘áº¿n nayâ€ â†’ start_date lÃ  thá»© 2 cá»§a tuáº§n hiá»‡n táº¡i, end_date lÃ  ngÃ y hiá»‡n táº¡i (current_date).\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i â€œtá»« Ä‘áº§u tuáº§n trÆ°á»›c Ä‘áº¿n nayâ€ hoáº·c â€œtá»« Ä‘áº§u tuáº§n vá»«a rá»“i Ä‘áº¿n nayâ€ â†’ start_date lÃ  thá»© 2 cá»§a tuáº§n trÆ°á»›c, end_date lÃ  ngÃ y hiá»‡n táº¡i (current_date).\n        - Náº¿u ngÆ°á»i dÃ¹ng nÃ³i \"tuáº§n trÆ°á»›c ná»¯a\" hoáº·c \"hai tuáº§n trÆ°á»›c\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : tá»« thá»© 2 Ä‘áº¿n Chá»§ nháº­t cá»§a tuáº§n liá»n trÆ°á»›c \"tuáº§n trÆ°á»›c\" (tá»©c cÃ¡ch tuáº§n hiá»‡n táº¡i 2 tuáº§n). VÃ­ dá»¥: Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i \"tuáº§n trÆ°á»›c ná»¯a\" â†’ start_date = 2025-02-17, end_date = 2025-02-23.\n    - VÃ­ dá»¥:\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"Tá»« mÃ¹ng 1 Ä‘áº¿n mÃ¹ng 6\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-01\", \"end_date\": \"2025-03-06\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"Tá»« 15 thÃ¡ng trÆ°á»›c Ä‘áº¿n 15 thÃ¡ng nÃ y\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-02-15\", \"end_date\": \"2025-03-15\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"Tá»« thá»© 3 tuáº§n trÆ°á»›c Ä‘áº¿n thá»© 3 tuáº§n nÃ y\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-02-25\", \"end_date\": \"2025-03-04\" (do 25/2 lÃ  thá»© Ba tuáº§n trÆ°á»›c, 4/3 lÃ  thá»© Ba tuáº§n nÃ y)\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"tuáº§n trÆ°á»›c\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-02-24\", \"end_date\": \"2025-03-02\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"tuáº§n nÃ y\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-03\", \"end_date\": \"2025-03-08\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"hai tuáº§n vá»«a rá»“i\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-02-19\", \"end_date\": \"2025-03-04\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"ba ngÃ y gáº§n nháº¥t\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-05\", \"end_date\": \"2025-03-07\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"ba ngÃ y vá»«a qua\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-05\", \"end_date\": \"2025-03-07\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"thÃ¡ng nÃ y\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-01\", \"end_date\": \"2025-03-08\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"thÃ¡ng trÆ°á»›c\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-02-01\", \"end_date\": \"2025-02-29\"\n        - Náº¿u current_date lÃ  2025-03-08 vÃ  ngÆ°á»i dÃ¹ng há»i: \"ná»­a Ä‘áº§u thÃ¡ng nÃ y\" thÃ¬ káº¿t quáº£ tÃ­nh toÃ¡n Ä‘Æ°á»£c sáº½ lÃ : \"start_date\": \"2025-03-01\", \"end_date\": \"2025-03-08\"\n- Káº¿t thÃºc bÆ°á»›c nÃ y:\n    - Náº¿u lÃ  má»™t ngÃ y cá»¥ thá»ƒ hoáº·c má»™t khoáº£ng thá»i gian cá»¥ thá»ƒ duy nháº¥t thÃ¬ sau khi xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c start_date vÃ  end_date, chuyá»ƒn sang **BÆ°á»›c 5** luÃ´n, khÃ´ng cáº§n láº·p láº¡i bÆ°á»›c nÃ y.\n    - Náº¿u lÃ  nhiá»u ngÃ y/má»‘c thá»i gian cá»¥ thá»ƒ hoáº·c nhiá»u khoáº£ng thá»i gian khÃ¡c nhau thÃ¬ pháº£i láº·p láº¡i **BÆ°á»›c 3** nÃ y cho tá»«ng khoáº£ng/má»‘c thá»i gian riÃªng biá»‡t, Ä‘áº¿n khi xá»­ lÃ½ xong toÃ n bá»™. Chá»‰ khi Ä‘Ã£ tÃ­nh Ä‘á»§ táº¥t cáº£ cÃ¡c cáº·p start_date, end_date, má»›i Ä‘Æ°á»£c chuyá»ƒn sang **BÆ°á»›c 5**.\n\n4. Náº¿u khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c má»‘c thá»i gian\n- Náº¿u ngá»¯ cáº£nh hiá»‡n táº¡i Ä‘Ã£ cÃ³ khoáº£ng thá»i gian thÃ¬ giá»¯ nguyÃªn.\n- Náº¿u khÃ´ng cÃ³ ngá»¯ cáº£nh thÃ¬ tráº£ vá» chuá»—i \"KhÃ´ng cÃ³\"\n- Náº¿u cÃ¢u há»i chá»©a cÃ¡c cá»¥m tá»« tham chiáº¿u ngá»¯ cáº£nh nhÆ°:\n    - â€œnhá»¯ng ngÃ y Ä‘Ã³â€, â€œnhá»¯ng hÃ´m Ä‘Ã³â€, â€œcÃ¡c ngÃ y Ä‘Ã³â€\n    - â€œnhá»¯ng hÃ´m Ä‘i muá»™n Ä‘Ã³â€, â€œnhá»¯ng ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã³â€, â€œcÃ¡c ngÃ y vi pháº¡m Ä‘Ã³â€\n    - hoáº·c biáº¿n thá»ƒ tÆ°Æ¡ng tá»±: â€œcÃ¡c ngÃ y áº¥yâ€, â€œnhá»¯ng lÃºc Ä‘Ã³â€, â€¦\n    thÃ¬ time_query sáº½ khÃ´ng pháº£i toÃ n bá»™ khoáº£ng thá»i gian trÆ°á»›c Ä‘Ã³, mÃ  chÃ­nh lÃ  **táº­p con cÃ¡c ngÃ y Ä‘Ã£ Ä‘Æ°á»£c káº¿t quáº£ cÃ¢u há»i trÆ°á»›c xÃ¡c Ä‘á»‹nh**. \n        - VÃ­ dá»¥:\n            - CÃ¢u trÆ°á»›c: â€œTuáº§n vá»«a rá»“i tÃ´i cÃ³ bao nhiÃªu ngÃ y Ä‘á»§ cÃ´ng?â€ thÃ¬ káº¿t quáº£ lÃ  cÃ¡c ngÃ y 2025-08-12, 2025-08-13, 2025-08-15.\n            - CÃ¢u sau: â€œThá»i gian check in, out cá»§a tÃ´i nhá»¯ng ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã³?â€ thÃ¬ time_query sáº½ lÃ  cÃ¡c ngÃ y 2025-08-12, 2025-08-13, 2025-08-15.\n\n5. Nháº­n diá»‡n thÃ´ng tin chá»§ Ä‘á» trong cÃ¢u há»i\n- Náº¿u ngÆ°á»i dÃ¹ng cÃ³ Ä‘á» cáº­p Ä‘áº¿n chá»§ Ä‘á» vÃ­ dá»¥ nhÆ°:\n    - â€œHÃ´m qua tÃ´i Ä‘i muá»™n khÃ´ng?â€\n    - â€œThá»i gian check in cá»§a tÃ´i thá»© 4 tuáº§n trÆ°á»›c lÃ  lÃºc nÃ o?â€\n    - â€œTÃ´i Ä‘Æ°á»£c bao nhiÃªu ngÃ y cÃ´ng trong tuáº§n nÃ y?â€\n    - â€œNgÃ y 1/8 tÃ´i cÃ³ bá»‹ Ä‘i muá»™n khÃ´ng?â€\nthÃ¬ xÃ¡c Ä‘á»‹nh CÃ³ Ä‘á» cáº­p Ä‘áº¿n chá»§ Ä‘á» vÃ  chuyá»ƒn sang **BÆ°á»›c 6**\n- Náº¿u ngÆ°á»i dÃ¹ng khÃ´ng Ä‘á» cáº­p Ä‘áº¿n báº¥t ká»³ chá»§ Ä‘á» nÃ o á»Ÿ trÃªn, hoáº·c chá»‰ nÃ³i Ä‘áº¿n thá»i gian chung chung mÃ  khÃ´ng gáº¯n vá»›i chá»§ Ä‘á», vÃ­ dá»¥:\n    - â€œHÃ´m nay thÃ¬ sao?â€\n    - â€œHÃ´m trÆ°á»›c thÃ¬ tháº¿ nÃ o?â€\n    - â€œThá»© 7 tuáº§n trÆ°á»›c thÃ¬ sao?â€\n    - \"Thá»© 2 vá»«a rá»“i thÃ¬ sao?\"\n    - \"Thá»© 3 vá»«a qua thÃ¬ tháº¿ nÃ o\"\n    - \"Thá»© 3 tuáº§n trÆ°á»›c ná»¯a?\"\nthÃ¬ xÃ¡c Ä‘á»‹nh KhÃ´ng Ä‘á» cáº­p Ä‘áº¿n chá»§ Ä‘á» vÃ  chuyá»ƒn sang **BÆ°á»›c 7** luÃ´n\n\n6. XÃ¡c Ä‘á»‹nh chá»§ Ä‘á»:\n- Náº¿u ngÆ°á»i dÃ¹ng há»i vá» thá»i gian check-in / check-out cá»¥ thá»ƒ trong ngÃ y. VÃ­ dá»¥:\n    - HÃ´m qua tÃ´i vÃ o lÃ m lÃºc máº¥y giá»?\n    - NgÃ y 10/7 tÃ´i cháº¥m cÃ´ng máº¥y giá»?\n    - HÃ´m nay tÃ´i cÃ³ quÃªn cháº¥m cÃ´ng khÃ´ng?\n    - Thá»i gian check-in hÃ´m kia cá»§a tÃ´i lÃ  máº¥y giá»?\n    - HÃ´m trÆ°á»›c tÃ´i check out lÃºc nÃ o?\n    - Thá»i gian check in, out cá»§a tÃ´i?\n    - CÃ²n thá»i gian check out thÃ¬ tháº¿ nÃ o?\nthÃ¬ xÃ¡c Ä‘á»‹nh chá»§ Ä‘á» lÃ  \"Thá»i gian Check-in / Check-out\" vÃ  tráº£ vá» luÃ´n, khÃ´ng cáº§n chuyá»ƒn sang **BÆ°á»›c 7**\n- Náº¿u ngÆ°á»i dÃ¹ng há»i vá» thÃ´ng tin vi pháº¡m (bao gá»“m cáº£ Ä‘i muá»™n, vá» sá»›m, vÃ  sá»‘ giá»/phÃºt vi pháº¡m). VÃ­ dá»¥:\n    - ThÃ¡ng trÆ°á»›c tÃ´i Ä‘i muá»™n bao nhiÃªu ngÃ y?\n    - Tuáº§n trÆ°á»›c tÃ´i vá» sá»›m máº¥y láº§n?\n    - Tuáº§n vá»«a rá»“i tÃ´i bá»‹ trá»« bao nhiÃªu phÃºt vÃ¬ Ä‘i trá»…?\n    - TÃ´i cÃ³ bá»‹ tÃ­nh Ä‘i trá»… ngÃ y nÃ o trong tuáº§n trÆ°á»›c khÃ´ng?\n    - Tá»•ng sá»‘ láº§n Ä‘i trá»… cá»§a tÃ´i trong thÃ¡ng 6 lÃ  bao nhiÃªu?\n    - Tá»•ng thá»i gian vi pháº¡m tuáº§n trÆ°á»›c lÃ  bao nhiÃªu?\n    - Thá»i gian vi pháº¡m cá»§a tÃ´i hÃ´m qua?\n    - Váº­y lÃ  cÃ³ bá»‹ tÃ­nh vá» sá»›m khÃ´ng?\n    - Tháº¿ lÃ  cÃ³ bá»‹ coi lÃ  Ä‘i muá»™n khÃ´ng?\n    - Tháº¿ bá»‹ tÃ­nh lÃ  Ä‘i muá»™n khÃ´ng? \n\nthÃ¬ xÃ¡c Ä‘á»‹nh chá»§ Ä‘á» lÃ  \"ThÃ´ng tin vi pháº¡m\" vÃ  tráº£ vá» luÃ´n, khÃ´ng cáº§n chuyá»ƒn sang **BÆ°á»›c 7**\n- Náº¿u ngÆ°á»i dÃ¹ng há»i vá» sá»‘ ngÃ y cÃ´ng hoáº·c viá»‡c Ä‘i lÃ m Ä‘á»§ ngÃ y. VÃ­ dá»¥:\n    - ThÃ¡ng nÃ y tÃ´i cÃ³ bao nhiÃªu ngÃ y cÃ´ng?\n    - TÃ´i Ä‘i lÃ m Ä‘á»§ cÃ´ng trong thÃ¡ng 6 khÃ´ng?\n    - Tá»•ng sá»‘ ngÃ y cÃ´ng cá»§a tÃ´i 2 tuáº§n vá»«a rá»“i lÃ  bao nhiÃªu?\nthÃ¬ xÃ¡c Ä‘á»‹nh chá»§ Ä‘á» lÃ  \"NgÃ y cÃ´ng\" vÃ  tráº£ vá» luÃ´n, khÃ´ng cáº§n chuyá»ƒn sang **BÆ°á»›c 7**\n- LÆ°u Ã½: \n    - Náº¿u trong cÃ¢u há»i vá»«a chá»©a thÃ´ng tin vá» má»™t chá»§ Ä‘á» cá»¥ thá»ƒ (vÃ­ dá»¥: check-in/check-out, vi pháº¡m) vá»«a cÃ³ thÃªm cá»¥m tá»« Ä‘iá»u kiá»‡n lá»c (vÃ­ dá»¥: â€œnhá»¯ng ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã³â€, â€œcÃ¡c ngÃ y Ä‘i muá»™n Ä‘Ã³â€), thÃ¬ **Æ°u tiÃªn xÃ¡c Ä‘á»‹nh chá»§ Ä‘á» chÃ­nh theo cÃ¢u há»i gá»‘c**. \n        - CÃ¡c cá»¥m nhÆ° â€œngÃ y Ä‘á»§ cÃ´ngâ€, â€œngÃ y vi pháº¡mâ€, â€œngÃ y Ä‘i muá»™nâ€ chá»‰ dÃ¹ng Ä‘á»ƒ **giá»›i háº¡n táº­p ngÃ y trong time_query**, khÃ´ng thay Ä‘á»•i topic.\n        - VÃ­ dá»¥:\n            - Vá»›i cÃ¢u há»i: â€œThá»i gian check in, out cá»§a tÃ´i nhá»¯ng ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã³?â€ thÃ¬ Topic = \"Thá»i gian Check-in / Check-out\" vÃ  Time_query = táº­p ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã£ xÃ¡c Ä‘á»‹nh tá»« cÃ¢u trÆ°á»›c\n    - Náº¿u cÃ¢u há»i thuá»™c loáº¡i nguyÃªn nhÃ¢n/giáº£i thÃ­ch (chá»©a tá»« khÃ³a WHY-intent: vÃ¬ sao, táº¡i sao, do Ä‘Ã¢u, nguyÃªn nhÃ¢n, lÃ½ do, â€¦) thÃ¬ Æ°u tiÃªn chá»§ Ä‘á» â€œThÃ´ng tin vi pháº¡mâ€, vÃ¬ má»i nguyÃªn nhÃ¢n dáº«n tá»›i máº¥t cÃ´ng hay sai lá»‡ch Ä‘á»u náº±m á»Ÿ layer â€œvi pháº¡mâ€.\n\n7. Náº¿u khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c chá»§ Ä‘á»:\n- Náº¿u ngá»¯ cáº£nh hiá»‡n táº¡i Ä‘Ã£ cÃ³ thÃ´ng tin vá» chá»§ Ä‘á» thÃ¬ thÃ´ng tin Ä‘Ã³ lÃ m chá»§ Ä‘á».\n- Náº¿u ngá»¯ cáº£nh hiá»‡n táº¡i khÃ´ng cÃ³ thÃ´ng vá» chá»§ Ä‘á» thÃ¬ tráº£ vá» chuá»—i \"KhÃ´ng cÃ³\"\n\nYÃªu cáº§u Ä‘áº§u ra JSON:\n- Sau khi hoÃ n táº¥t cÃ¡c bÆ°á»›c phÃ¢n tÃ­ch trÃªn, hÃ£y tráº£ vá» DUY NHáº¤T má»™t chuá»—i JSON há»£p lá»‡ (khÃ´ng cÃ³ vÄƒn báº£n giáº£i thÃ­ch, khÃ´ng cÃ³ chÃº thÃ­ch) vá»›i cáº¥u trÃºc sau:\n    - Top-level object cÃ³ cÃ¡c trÆ°á»ng:\n        - \"topic\": string â€” giÃ¡ trá»‹ chá»§ Ä‘á» Ä‘Ã£ nháº­n diá»‡n á»Ÿ BÆ°á»›c 5, 6, 7.\n        - \"time_query\": array of objects â€” má»—i object Ä‘áº¡i diá»‡n cho má»™t cáº·p start_date / end_date Ä‘Ã£ nháº­n diá»‡n á»Ÿ BÆ°á»›c 1, 2, 3, 4.\n\n    - Schema cho time_query (má»—i pháº§n tá»­):\n        {\n            \"start_date\": \"YYYY-MM-DD\",\n            \"end_date\": \"YYYY-MM-DD\"\n        }\n\n    - VÃ­ dá»¥ Ä‘áº§u ra há»£p lá»‡:\n        {\n            \"topic\": \"Thá»i gian Check-in / Check-out\",\n            \"time_query\": [\n                {\n                    \"start_date\": \"2025-08-07\",\n                    \"end_date\": \"2025-08-07\"\n                }\n            ]\n        }\n\n        {\n            \"topic\": \"NgÃ y cÃ´ng\",\n            \"time_query\": [\n                {\n                    \"start_date\": \"2025-07-01\",\n                    \"end_date\": \"2025-07-15\"\n                }\n            ]\n        }\n",
              "dataset_uuid": "",
              "dataset_qa_uuid": "",
              "rag_query": "",
              "limit": "2",
              "api_key": "",
              "knowledge": "",
              "knowledge_aware": false,
              "chat_history_aware": false,
              "human_input_aware": true,
              "varReply": "context",
              "temperature": "0.7",
              "max_tokens": "16000",
              "stop": "",
              "stop_regex": "",
              "pattern": "",
              "json_mode": true,
              "multimodal_mode": false,
              "tools": "",
              "agent_loop": true,
              "llm_alt_model": "gpt-4o-mini"
            },
            "name": "AI GPT-4o Context Handler"
          },
          {
            "id": "a848168543313429d9679e2e65c120af",
            "type": "setVar",
            "componentType": "task",
            "properties": {
              "varName": "context_json",
              "varValue": "json.loads(context)"
            },
            "name": "Var [context_json]"
          },
          {
            "id": "c4f3fbd1829bb9da135aeb29226660a8",
            "type": "python",
            "componentType": "task",
            "properties": {
              "varName": "check_json",
              "expression": "def check_keys( json_check, keys ):\n    for key in keys:\n        if key not in json_check:\n            return \"No\"\n    return \"Yes\"\n\nbot_check_json = {{ context_json }}\nkeys_to_check = [ \"topic\", \"time_query\" ]\n\nprint( check_keys( bot_check_json, keys_to_check ) )"
            },
            "name": "Python"
          },
          {
            "id": "8236c9dfdef07d63c889358eb4c3bb28",
            "type": "if",
            "componentType": "switch",
            "properties": {
              "condition": "check_json == \"Yes\""
            },
            "branches": {
              "true": [
                {
                  "id": "876c413da1ec786236ae3c1623aa0c2f",
                  "type": "qna",
                  "componentType": "task",
                  "properties": {
                    "instruction": "Dá»±a vÃ o ngá»¯ cáº£nh hiá»‡n táº¡i cÅ©ng nhÆ° cÃ¢u tráº£ lá»i trÆ°á»›c Ä‘Ã³ cá»§a llm, hÃ£y xÃ¡c Ä‘á»‹nh xem cÃ¢u tráº£ lá»i mÃ  llm trÆ°á»›c Ä‘Ã³ Ä‘Æ°a ra Ä‘Ã£ phÃ¹ há»£p chÆ°a.\n\nNgá»¯ cáº£nh hiá»‡n táº¡i:\n- NgÃ y hiá»‡n táº¡i: {{ current_time }}\n- Khoáº£ng thá»i gian mÃ  ngÆ°á»i dÃ¹ng Ä‘ang nháº¯c Ä‘áº¿n trong cÃ¢u há»i trÆ°á»›c Ä‘Ã³:\n{{ time_query_in_string }}\n- Chá»§ Ä‘á» mÃ  ngÆ°á»i dÃ¹ng Ä‘ang nháº¯c Ä‘áº¿n trong cÃ¢u há»i trÆ°á»›c Ä‘Ã³: {{ current_topic }}\n\n- CÃ¢u há»i trÆ°á»›c Ä‘Ã³ cá»§a ngÆ°á»i dÃ¹ng: {{ prev_question }}\n- CÃ¢u tráº£ lá»i cho cÃ¢u há»i trÆ°á»›c Ä‘Ã³: \n{{ prev_answer }}\n\n- CÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng: {{ user_input }}\n- Káº¿t quáº£ JSON cá»§a llm trÆ°á»›c Ä‘Ã³: {{ context }}\n\n- LÆ°u Ã½:\n    - Cáº·p cÃ¢u há»i vÃ  cÃ¢u tráº£ lá»i trÆ°á»›c Ä‘Ã³ chá»‰ mang tÃ­nh cháº¥t tham kháº£o vÃ  chá»‰ sá»­ dá»¥ng náº¿u cÃ¢u há»i hiá»‡n táº¡i yÃªu cáº§u liÃªn káº¿t vá»›i má»‘c thá»i gian Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» cáº­p trong cÃ¢u trÆ°á»›c.\n    - VÃ­ dá»¥:\n        - CÃ¢u 1: â€œTuáº§n vá»«a rá»“i cÃ³ hÃ´m nÃ o tÃ´i Ä‘i muá»™n khÃ´ng?â€\n        - CÃ¢u 2: â€œThá»i gian check in nhá»¯ng ngÃ y Ä‘Ã³?â€\n        â†’ á»ž cÃ¢u 2, cáº§n láº¥y má»‘c thá»i gian tá»« cÃ¢u tráº£ lá»i cá»§a cÃ¢u 1 (â€œnhá»¯ng ngÃ y Ä‘Ã³â€ = cÃ¡c ngÃ y Ä‘i muá»™n trong tuáº§n vá»«a rá»“i) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c khoáº£ng thá»i gian.\n\nQuy táº¯c xÃ¡c Ä‘á»‹nh:\n- Kiá»ƒm tra cáº¥u trÃºc JSON\n    - JSON pháº£i cÃ³ Ä‘Ãºng 2 field:\n        - \"topic\": string\n        - \"time_query\": array cÃ¡c object {start_date, end_date} (format YYYY-MM-DD)\nnáº¿u sai cáº¥u trÃºc thÃ¬ \"is_valid\": \"False\"\n\n- XÃ¡c Ä‘á»‹nh thá»i gian (time_query):\n    - Náº¿u cÃ¢u há»i cÃ³ ngÃ y/thÃ¡ng/nÄƒm, tá»« khÃ³a chá»‰ má»‘c hoáº·c khoáº£ng thá»i gian cá»¥ thá»ƒ/tÆ°Æ¡ng Ä‘á»‘i thÃ¬ pháº£i táº¡o cáº·p start_date, end_date phÃ¹ há»£p.\n    - Náº¿u cÃ¢u há»i chá»©a nhiá»u má»‘c/khoáº£ng â†’ pháº£i cÃ³ nhiá»u cáº·p trong time_query.\n    - Náº¿u cÃ¢u há»i dÃ¹ng tham chiáº¿u mÆ¡ há»“ (\"hÃ´m Ä‘Ã³\", \"nhá»¯ng ngÃ y Ä‘Ã³\") â†’ time_query pháº£i láº¥y tá»« ngá»¯ cáº£nh trÆ°á»›c.\n    - Náº¿u khÃ´ng cÃ³ thá»i gian â†’ time_query lÃ  \"KhÃ´ng cÃ³\" hoáº·c giá»¯ nguyÃªn tá»« ngá»¯ cáº£nh trÆ°á»›c.\n- XÃ¡c Ä‘á»‹nh chá»§ Ä‘á» (topic):\n    - Náº¿u cÃ¢u há»i vá» giá» vÃ o/ra, check-in/out â†’ \"Thá»i gian Check-in / Check-out\".\n    - Náº¿u cÃ¢u há»i vá» Ä‘i muá»™n, vá» sá»›m, vi pháº¡m â†’ \"ThÃ´ng tin vi pháº¡m\".\n    - Náº¿u cÃ¢u há»i vá» sá»‘ ngÃ y cÃ´ng, Ä‘á»§ cÃ´ng â†’ \"NgÃ y cÃ´ng\".\n    - Náº¿u cÃ¢u há»i khÃ´ng cÃ³ chá»§ Ä‘á» má»›i â†’ dÃ¹ng chá»§ Ä‘á» ngá»¯ cáº£nh trÆ°á»›c; náº¿u cÅ©ng khÃ´ng cÃ³ thÃ¬ \"KhÃ´ng cÃ³\".\n- Quan há»‡ thá»i gian & chá»§ Ä‘á»:\n    - Náº¿u cÃ¢u há»i chá»‰ nháº¯c Ä‘áº¿n thá»i gian mÃ  khÃ´ng cÃ³ chá»§ Ä‘á» â†’ \"topic\": \"KhÃ´ng cÃ³\".\n    - Náº¿u cÃ³ chá»§ Ä‘á» nhÆ°ng thiáº¿u thá»i gian â†’ váº«n pháº£i cÃ³ time_query, láº¥y tá»« ngá»¯ cáº£nh trÆ°á»›c hoáº·c \"KhÃ´ng cÃ³\".\n    - Náº¿u cÃ¢u há»i cÃ³ cá»¥m lá»c ngÃ y (â€œnhá»¯ng ngÃ y Ä‘á»§ cÃ´ng Ä‘Ã³â€, â€œnhá»¯ng ngÃ y Ä‘i muá»™n Ä‘Ã³â€) â†’ khÃ´ng Ä‘á»•i topic, chá»‰ giá»›i háº¡n time_query.\n\n- Äá»‹nh dáº¡ng JSON há»£p lá»‡:\n    - Pháº£i tráº£ vá» object cÃ³ 2 trÆ°á»ng: \"topic\" (string), \"time_query\" (array cÃ¡c object {start_date, end_date}).\n    - NgÃ y theo format YYYY-MM-DD.\n\nLÆ°u Ã½:\n- time_query tá»« LLM chá»‰ cáº§n cover Ä‘áº§y Ä‘á»§ khoáº£ng thá»i gian user há»i, khÃ´ng quan trá»ng cÃ¡ch biá»ƒu diá»…n.\n- VÃ­ dá»¥: user há»i tá»« 20â€“24/08, thÃ¬ time_query cÃ³ thá»ƒ lÃ  \n[\n    {\"start_date\": \"2025-08-20\", \"end_date\": \"2025-08-24\"}\n] \nhoáº·c \n[\n  {\"start_date\": \"2025-08-20\", \"end_date\": \"2025-08-20\"},\n  {\"start_date\": \"2025-08-21\", \"end_date\": \"2025-08-21\"},\n  {\"start_date\": \"2025-08-22\", \"end_date\": \"2025-08-22\"},\n  {\"start_date\": \"2025-08-23\", \"end_date\": \"2025-08-23\"},\n  {\"start_date\": \"2025-08-24\", \"end_date\": \"2025-08-24\"}\n]\nthÃ¬ cáº£ hai Ä‘á»u há»£p lá»‡ cÃ²n khÃ´ng cover Ä‘áº§y Ä‘á»§ thÃ¬ tÃ­nh lÃ  khÃ´ng há»£p lá»‡.\n\nYÃªu cáº§u Ä‘áº§u ra JSON:\n- Sau khi hoÃ n táº¥t cÃ¡c bÆ°á»›c phÃ¢n tÃ­ch, xÃ¡c Ä‘á»‹nh trÃªn, hÃ£y tráº£ vá» DUY NHáº¤T má»™t chuá»—i JSON há»£p lá»‡ (khÃ´ng cÃ³ vÄƒn báº£n giáº£i thÃ­ch, khÃ´ng cÃ³ chÃº thÃ­ch) vá»›i cáº¥u trÃºc sau:\n    - Top-level object cÃ³ cÃ¡c trÆ°á»ng:\n        - \"is_valid\": string - chá»‰ cÃ³ thá»ƒ nháº­n má»™t trong hai giÃ¡ trá»‹ chuá»—i lÃ  \"True\" hoáº·c \"False\"\n\n    - VÃ­ dá»¥ Ä‘áº§u ra há»£p lá»‡:\n        {\n            \"is_valid\": \"True\"\n        }\n\n        {\n            \"is_valid\": \"False\"\n        }\n",
                    "dataset_uuid": "",
                    "dataset_qa_uuid": "",
                    "rag_query": "",
                    "limit": "2",
                    "api_key": "",
                    "knowledge": "{{ knowledge_from_rag }}",
                    "knowledge_aware": false,
                    "chat_history_aware": false,
                    "human_input_aware": true,
                    "varReply": "validator_result",
                    "temperature": "0.7",
                    "max_tokens": "16000",
                    "stop": "",
                    "stop_regex": "",
                    "pattern": "",
                    "json_mode": true,
                    "multimodal_mode": false,
                    "tools": "",
                    "agent_loop": false,
                    "llm_alt_model": "gpt-mini"
                  },
                  "name": "AI GPT-4o Validator"
                },
                {
                  "id": "b0d9c4577e2443ef450aeb7c16f129dd",
                  "type": "python",
                  "componentType": "task",
                  "properties": {
                    "varName": "check_json_1",
                    "expression": "def check_keys( json_check, keys ):\n    for key in keys:\n        if key not in json_check:\n            return \"No\"\n    return \"Yes\"\n\nbot_check_json = {{ validator_result }}\nkeys_to_check = [ \"is_valid\" ]\n\nprint( check_keys( bot_check_json, keys_to_check ) )"
                  },
                  "name": "Python"
                },
                {
                  "id": "94ded025e89468c594f2af0ada2ab93e",
                  "type": "if",
                  "componentType": "switch",
                  "properties": {
                    "condition": "check_json_1 == \"Yes\""
                  },
                  "branches": {
                    "true": [
                      {
                        "id": "4ac3f91171136c7a33df101680767902",
                        "type": "setVar",
                        "componentType": "task",
                        "properties": {
                          "varName": "validator_result_json",
                          "varValue": "json.loads(validator_result)"
                        },
                        "name": "Var [validator_result_json]"
                      },
                      {
                        "id": "d215894175481c7ff97504c94e0f6ae9",
                        "type": "if",
                        "componentType": "switch",
                        "properties": {
                          "condition": "validator_result_json.is_valid == \"True\""
                        },
                        "branches": {
                          "true": [
                            {
                              "id": "7b22cd44efa55eebfc0fa0b356846a90",
                              "type": "python",
                              "componentType": "task",
                              "properties": {
                                "varName": "saved_context_data",
                                "expression": "import json\n\ncontext_json = {{ context_json }}\nuser_id = \"{{ user_id }}\"\n\ndef create_query_data( session_id, context_json ):\n\n    query_data = {\n        \"session_id\": session_id,\n        \"data\": {\n            \"time_query\": context_json[ \"time_query\" ],\n            \"topic\": context_json[ \"topic\" ]\n        }\n    }\n    return json.dumps( query_data )\n\nprint( create_query_data( user_id, context_json ) )\n"
                              },
                              "name": "Python"
                            },
                            {
                              "id": "beac7729b9ebc4ed502a1c0a0a39199d",
                              "type": "botAPICall",
                              "componentType": "task",
                              "properties": {
                                "api_response_var_name": "session_upsert_result",
                                "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/session/upsert",
                                "api_body": "{{ saved_context_data }}",
                                "api_header": "{\n    \"Content-Type\": \"application/json\"\n}",
                                "api_method": "POST"
                              },
                              "name": "Bot API Call"
                            },
                            {
                              "id": "cf91af3d6d1eb117f68bdeb6b62fd2c8",
                              "type": "if",
                              "componentType": "switch",
                              "properties": {
                                "condition": "len( context_json.get( 'time_query', []  ) ) > 0"
                              },
                              "branches": {
                                "true": [
                                  {
                                    "id": "826ad3be7b9755f95d3231678790e448",
                                    "type": "python",
                                    "componentType": "task",
                                    "properties": {
                                      "varName": "query_data_1",
                                      "expression": "import json\n\ncontext_json = {{ context_json }}\nuser_email = \"{{ user_email }}\"\n\ndef create_query_data( user_email, context_json ):\n     time_query = context_json[ \"time_query\" ]\n\n     query_data = {\n    \"user_email\": user_email,\n    \"time_query\": time_query\n}\n     return json.dumps(query_data)\n\nprint( create_query_data( user_email, context_json ) )\n"
                                    },
                                    "name": "Python"
                                  },
                                  {
                                    "id": "d6b12ef337b1f082d7fa63d417da5d6a",
                                    "type": "botAPICall",
                                    "componentType": "task",
                                    "properties": {
                                      "api_response_var_name": "check_dayoff_result",
                                      "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/day-off/check",
                                      "api_body": "{{ query_data_1 }}",
                                      "api_header": "{\"Authorization\": \"Bearer token\"}",
                                      "api_method": "POST"
                                    },
                                    "name": "Bot API Call"
                                  },
                                  {
                                    "id": "18e127a5306cb1e4d9e7975a59fe9eaf",
                                    "type": "python",
                                    "componentType": "task",
                                    "properties": {
                                      "varName": "is_dayoff",
                                      "expression": "check_dayoff_obj = {{ check_dayoff_result }}\n\nprint( check_dayoff_obj[ \"is_dayoff\" ] )"
                                    },
                                    "name": "Python"
                                  },
                                  {
                                    "id": "1056795dbb466ef3bbf1e55ef0173322",
                                    "type": "if",
                                    "componentType": "switch",
                                    "properties": {
                                      "condition": "is_dayoff == \"False\""
                                    },
                                    "branches": {
                                      "true": [
                                        {
                                          "id": "2ac6240196365f1298ece9ea2f3b428a",
                                          "type": "if",
                                          "componentType": "switch",
                                          "properties": {
                                            "condition": "context_json.get( 'topic', 'KhÃ´ng cÃ³' ) != 'KhÃ´ng cÃ³'"
                                          },
                                          "branches": {
                                            "true": [
                                              {
                                                "id": "4f11f15fd1f2fb8cc5bb311c256d1211",
                                                "type": "python",
                                                "componentType": "task",
                                                "properties": {
                                                  "varName": "query_data",
                                                  "expression": "import json\n\nsession_obj = {{ api_session_info }}\ncontext_json = {{ context_json }}\nuser_email = \"{{ user_email }}\"\n\ndef create_query_data( user_email, context_json ):\n     time_query = context_json[ \"time_query\" ]\n\n     query_data = {\n    \"user_email\": user_email,\n    \"time_query\": time_query\n}\n     return json.dumps(query_data)\n\nprint( create_query_data( user_email, context_json ) )\n"
                                                },
                                                "name": "Python"
                                              },
                                              {
                                                "id": "c1a564c4274d1cf830aa6d17d642d1f9",
                                                "type": "parallel",
                                                "componentType": "switch",
                                                "properties": {
                                                  "conditions": {
                                                    "Thá»i gian Check-in / Check-out cá»¥ thá»ƒ": "context_json.get( 'topic', 'KhÃ´ng cÃ³' ) == 'Thá»i gian Check-in / Check-out'",
                                                    "NgÃ y cÃ´ng": "context_json.get( 'topic', 'KhÃ´ng cÃ³' ) == 'NgÃ y cÃ´ng'\n",
                                                    "ThÃ´ng tin vi pháº¡m": "context_json.get( 'topic', 'KhÃ´ng cÃ³' ) == 'ThÃ´ng tin vi pháº¡m'"
                                                  }
                                                },
                                                "branches": {
                                                  "Thá»i gian Check-in / Check-out cá»¥ thá»ƒ": [
                                                    {
                                                      "id": "b1d19dae23b34ecfef51e86e6f5ffc4e",
                                                      "type": "botAPICall",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "api_response_var_name": "attendance_data",
                                                        "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/search/time",
                                                        "api_body": "{{ query_data }}",
                                                        "api_header": "{\n    \"Content-Type\": \"application/json\"\n}",
                                                        "api_method": "POST"
                                                      },
                                                      "name": "Bot API Call"
                                                    },
                                                    {
                                                      "id": "726861095d58707b3f31c510a179cf33",
                                                      "type": "python",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "varName": "processed_data",
                                                        "expression": "attendance_data = {{ attendance_data }}\n\ndef process_data( attendance_data ):\n    summary_parts = []\n    summary_parts.append( \"Thá»i gian check in/out:\\n\" )\n\n    for index, record in enumerate( attendance_data[ \"data\" ] ):\n        summary_parts.append( f\"NgÃ y: { record.get( 'date', 'khÃ´ng cÃ³' ) }\" )\n\n        checkin_text = \"check in time: \"\n        checkin_text += record.get( \"checkin_time\" ) or \"khÃ´ng cÃ³\"\n        summary_parts.append( checkin_text )\n\n        checkout_text = \"check out time: \"\n        checkout_text += record.get( \"checkout_time\" ) or \"khÃ´ng cÃ³\"\n        summary_parts.append( checkout_text )\n\n        if index < len( attendance_data[ \"data\" ] ) - 1:\n            summary_parts.append( \"\" )  # dÃ²ng trá»‘ng giá»¯a cÃ¡c báº£n ghi\n\n    final_summary = \"\\n\".join( summary_parts )\n    return final_summary\n\nprint( process_data( attendance_data ) )"
                                                      },
                                                      "name": "Python"
                                                    }
                                                  ],
                                                  "NgÃ y cÃ´ng": [
                                                    {
                                                      "id": "a38d92dca86a3b9e480a1bc6039c0e7e",
                                                      "type": "botAPICall",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "api_response_var_name": "attendance_data",
                                                        "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/search/attendance",
                                                        "api_body": "{{ query_data }}",
                                                        "api_header": "{\n    \"Content-Type\": \"application/json\"\n}",
                                                        "api_method": "POST"
                                                      },
                                                      "name": "Bot API Call"
                                                    },
                                                    {
                                                      "id": "ed4fbb9d8692b1ed79bbcf128185479d",
                                                      "type": "python",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "varName": "processed_data",
                                                        "expression": "attendance_data = {{ attendance_data }}\n\ndef process_data(attendance_data):\n    # Khá»Ÿi táº¡o biáº¿n thá»‘ng kÃª\n    total_attendance = 0.0  # Äá»•i thÃ nh float Ä‘á»ƒ tÃ­nh tá»•ng chÃ­nh xÃ¡c\n    full_days = 0\n    partial_days = 0  # Äá»•i tÃªn tá»« half_days thÃ nh partial_days vÃ¬ khÃ´ng chá»‰ cÃ³ 0.5\n    total_working_days = 0\n    total_actual_hours = 0.0  # ThÃªm biáº¿n Ä‘á»ƒ tÃ­nh tá»•ng giá» lÃ m viá»‡c thá»±c táº¿\n    total_deduction_hours = 0.0\n\n    full_day_dates = []\n    partial_day_dates = []  # LÆ°u cáº£ ngÃ y vÃ  há»‡ sá»‘ cÃ´ng tÆ°Æ¡ng á»©ng\n\n    # Xá»­ lÃ½ dá»¯ liá»‡u - duyá»‡t qua tá»«ng báº£n ghi Ä‘á»ƒ tÃ­nh toÃ¡n vÃ  phÃ¢n loáº¡i\n    for record in attendance_data[\"data\"]:\n        working_days = record.get(\"workingDays\", 0)\n        actual_hours = record.get(\"actualHours\", 0)\n        deduction_hours = record.get(\"deductionHours\", 0)\n        date = record.get(\"date\", \"\")\n        \n        # Cá»™ng dá»“n cÃ¡c giÃ¡ trá»‹ tá»•ng\n        total_attendance += working_days\n        total_actual_hours += actual_hours\n        total_deduction_hours += deduction_hours\n        total_working_days += 1\n\n        # PhÃ¢n loáº¡i dá»±a trÃªn há»‡ sá»‘ workingDays\n        # NgÃ y Ä‘á»§ cÃ´ng: workingDays >= 1.0 (hoáº·c gáº§n báº±ng 1.0 do lÃ m trÃ²n sá»‘ thá»±c)\n        if working_days >= 0.99:  # Sá»­ dá»¥ng 0.99 thay vÃ¬ 1.0 Ä‘á»ƒ trÃ¡nh lá»—i lÃ m trÃ²n sá»‘ thá»±c\n            full_days += 1\n            full_day_dates.append(date)\n        # NgÃ y lÃ m má»™t pháº§n: workingDays > 0 nhÆ°ng < 1.0\n        elif working_days > 0:\n            partial_days += 1\n            # LÆ°u cáº£ ngÃ y vÃ  há»‡ sá»‘ cÃ´ng Ä‘á»ƒ hiá»ƒn thá»‹ chi tiáº¿t\n            partial_day_dates.append((date, working_days, actual_hours))\n\n    # Táº¡o ná»™i dung summary vá»›i thÃ´ng tin chi tiáº¿t hÆ¡n\n    summary_parts = []\n    \n    # ThÃ´ng tin tá»•ng quan\n    summary_parts.append(f\"Tá»•ng sá»‘ ngÃ y cÃ´ng: {total_attendance:.3f}\")  # Hiá»ƒn thá»‹ 3 sá»‘ tháº­p phÃ¢n\n    summary_parts.append(\"\")\n    summary_parts.append(f\"Tá»•ng sá»‘ giá» cÃ´ng bá»‹ trá»«: {total_deduction_hours:.3f}\")  # Hiá»ƒn thá»‹ 3 sá»‘ tháº­p phÃ¢n\n    summary_parts.append(\"\")\n    summary_parts.append(f\"Tá»•ng sá»‘ giá» cÃ´ng (giá» lÃ m viá»‡c): {total_actual_hours:.1f} giá»\")\n    summary_parts.append(\"\")\n    \n    # Chi tiáº¿t ngÃ y lÃ m Ä‘á»§ cÃ´ng\n    summary_parts.append(f\"Sá»‘ ngÃ y lÃ m Ä‘á»§ cÃ´ng (â‰¥1.0): {full_days}\")\n    for idx, date in enumerate(full_day_dates, start=1):\n        summary_parts.append(f\"  {idx}. {date}\")\n    summary_parts.append(\"\")\n\n    # Chi tiáº¿t ngÃ y lÃ m má»™t pháº§n cÃ´ng\n    summary_parts.append(f\"Sá»‘ ngÃ y lÃ m má»™t pháº§n cÃ´ng (<1.0): {partial_days}\")\n    for idx, (date, working_days, actual_hours) in enumerate(partial_day_dates, start=1):\n        # Hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t: ngÃ y, há»‡ sá»‘ cÃ´ng, sá»‘ giá» thá»±c táº¿\n        summary_parts.append(f\"  {idx}. {date} - {working_days:.3f} cÃ´ng ({actual_hours}h)\")\n\n    # GhÃ©p thÃ nh chuá»—i káº¿t quáº£\n    final_summary = \"\\n\".join(summary_parts)\n    return final_summary\n\nprint( process_data( attendance_data ) )\n"
                                                      },
                                                      "name": "Python"
                                                    }
                                                  ],
                                                  "ThÃ´ng tin vi pháº¡m": [
                                                    {
                                                      "id": "2ec2ce155c34437464f38dea3ef4d8bf",
                                                      "type": "botAPICall",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "api_response_var_name": "attendance_data",
                                                        "api_url": "https://screen-rebates-diversity-partner.trycloudflare.com/api/search/late",
                                                        "api_body": "{{ query_data }}",
                                                        "api_header": "{\n    \"Content-Type\": \"application/json\"\n}",
                                                        "api_method": "POST"
                                                      },
                                                      "name": "Bot API Call"
                                                    },
                                                    {
                                                      "id": "1f907c8d235bdebfa0849a0b32a0d9a2",
                                                      "type": "python",
                                                      "componentType": "task",
                                                      "properties": {
                                                        "varName": "processed_data",
                                                        "expression": "attendance_data = {{ attendance_data }}\n\ndef process_data(attendance_data):\n    summary_parts = []\n\n    total_deduction_hours = 0\n    total_violation_days = 0\n    total_late_days = 0\n    total_late_minutes = 0\n    total_early_days = 0\n    total_early_minutes = 0\n\n    for record in attendance_data[\"data\"]:\n        checkin_violation = record.get(\"checkin_violation\", 0)\n        checkout_violation = record.get(\"checkout_violation\", 0)\n        deduction_hours = record.get(\"deduction_hours\", 0)\n\n        if checkin_violation > 0 or checkout_violation > 0:\n            total_violation_days += 1\n\n        total_deduction_hours += deduction_hours\n        if checkin_violation > 0:\n            total_late_days += 1\n            total_late_minutes += checkin_violation\n        if checkout_violation > 0:\n            total_early_days += 1\n            total_early_minutes += checkout_violation\n\n    # Chuá»—i tá»•ng há»£p\n    summary_header = (\n        f\"Tá»•ng sá»‘ ngÃ y vi pháº¡m bao gá»“m cáº£ Ä‘i muá»™n vÃ  vá» sá»›m: {total_violation_days} ngÃ y\\n\"\n        f\"Tá»•ng sá»‘ giá» cÃ´ng bá»‹ trá»«: {total_deduction_hours}h\\n\"\n        f\"Tá»•ng sá»‘ ngÃ y Ä‘i muá»™n: {total_late_days} (tá»•ng {total_late_minutes} phÃºt)\\n\"\n        f\"Tá»•ng sá»‘ ngÃ y vá» sá»›m: {total_early_days} (tá»•ng {total_early_minutes} phÃºt)\\n\"\n    )\n    summary_parts.append(summary_header)\n\n    for index, record in enumerate(attendance_data[\"data\"]):\n        # XÃ¡c Ä‘á»‹nh tráº¡ng thÃ¡i dá»±a trÃªn tá»•ng sá»‘ vi pháº¡m\n        if record.get(\"total_violation\", 0) > 0:\n            # Táº¡o thÃ´ng tin chi tiáº¿t vá» vi pháº¡m\n            checkin_violation = record.get(\"checkin_violation\", 0)\n            checkout_violation = record.get(\"checkout_violation\", 0)\n            deduction_hours = record.get(\"deduction_hours\", 0)\n            \n            # XÃ¢y dá»±ng chuá»—i mÃ´ táº£ vi pháº¡m\n            violation_details = []\n            if checkin_violation > 0:\n                violation_details.append(f\"Ä‘i muá»™n {checkin_violation} phÃºt\")\n            else:\n                violation_details.append(\"khÃ´ng Ä‘i muá»™n\")\n\n            if checkout_violation > 0:\n                violation_details.append(f\"vá» sá»›m {checkout_violation} phÃºt\")\n            else:\n                violation_details.append(\"khÃ´ng vá» sá»›m\")\n\n            violation_text = \" vÃ  \".join(violation_details)\n            status_text = f\"Vi pháº¡m: {violation_text} (trá»« {deduction_hours}h)\"\n        else:\n            status_text = \"KhÃ´ng vi pháº¡m (trá»« 0h)\"\n        \n        # Táº¡o chuá»—i tÃ³m táº¯t cho tá»«ng ngÃ y\n        summary_parts.append(f\"NgÃ y: {record.get('date', 'khÃ´ng cÃ³')} - {status_text}\")\n\n        # ThÃªm dÃ²ng trá»‘ng giá»¯a cÃ¡c báº£n ghi (trá»« báº£n ghi cuá»‘i cÃ¹ng)\n        if index < len(attendance_data[\"data\"]) - 1:\n            summary_parts.append(\"\")\n\n    final_summary = \"\\n\".join(summary_parts)\n    return final_summary\n\nprint( process_data( attendance_data ) )\n"
                                                      },
                                                      "name": "Python"
                                                    }
                                                  ]
                                                },
                                                "name": "Parallel"
                                              },
                                              {
                                                "id": "90eebd73d425ec71fc7f94288daadb63",
                                                "type": "qna",
                                                "componentType": "task",
                                                "properties": {
                                                  "instruction": "Vai trÃ²:\n- Báº¡n lÃ  trá»£ lÃ½ tÃªn Minh Hiá»ƒn, trá»£ lÃ½ áº£o chuyÃªn biá»‡t há»— trá»£ há»i Ä‘Ã¡p cháº¥m cÃ´ng. Báº¡n hÃ£y luÃ´n giao tiáº¿p báº±ng ngÃ´n ngá»¯ mÃ  NgÆ°á»i dÃ¹ng Æ°a thÃ­ch vÃ  thÃ­ch á»©ng vá»›i phong cÃ¡ch giao tiáº¿p cá»§a NgÆ°á»i dÃ¹ng.\n- Báº¡n lÃ  chuyÃªn gia giÃ u kiáº¿n thá»©c vá» há»‡ thá»‘ng quáº£n lÃ½ cháº¥m cÃ´ng, cung cáº¥p hÆ°á»›ng dáº«n chuyÃªn sÃ¢u vá» theo dÃµi thá»i gian lÃ m viá»‡c. Báº¡n xuáº¥t sáº¯c trong viá»‡c phÃ¢n tÃ­ch mÃ´ hÃ¬nh cháº¥m cÃ´ng cá»§a ngÆ°á»i dÃ¹ng, nháº­n diá»‡n cÃ¡c váº¥n Ä‘á» tiá»m áº©n vÃ  Ä‘Æ°a ra cÃ¡c giáº£i phÃ¡p hÃ nh Ä‘á»™ng nháº±m cáº£i thiá»‡n quáº£n lÃ½ thá»i gian.\n\n\nKÄ© nÄƒng:\n- Trá»£ lÃ½ thÃ nh tháº¡o trong viá»‡c xá»­ lÃ½ cÃ¡c phÃ©p tÃ­nh cháº¥m cÃ´ng phá»©c táº¡p, phÃ¢n tÃ­ch so sÃ¡nh vÃ  táº¡o cÃ¡c bÃ¡o cÃ¡o cÃ³ Ã½ nghÄ©a. Trá»£ lÃ½ luÃ´n tráº£ lá»i báº±ng ngÃ´n ngá»¯ mÃ  NgÆ°á»i dÃ¹ng Ä‘ang sá»­ dá»¥ng, Ä‘á»“ng thá»i Ä‘iá»u chá»‰nh giá»ng Ä‘iá»‡u vÃ  má»©c Ä‘á»™ chi tiáº¿t sao cho phÃ¹ há»£p vá»›i sá»Ÿ thÃ­ch cá»§a NgÆ°á»i dÃ¹ng.\n\n\nGiá»ng Ä‘iá»‡u:\n- HÃ i hÆ°á»›c vÃ  chÃ¢m biáº¿m Ä‘Ã´i khi khÃ³ truyá»n táº£i qua vÄƒn báº£n, vÃ¬ váº­y hÃ£y giá»¯ ná»™i dung rÃµ rÃ ng, trÃ¡nh gÃ¢y hiá»ƒu láº§m.\n- Ngay cáº£ khi trÃ² chuyá»‡n thÃ¢n máº­t, báº¡n váº«n pháº£i giá»¯ má»©c Ä‘á»™ chuyÃªn nghiá»‡p nháº¥t Ä‘á»‹nh, Ä‘áº£m báº£o tÆ°Æ¡ng tÃ¡c lá»‹ch sá»± vÃ  tÃ´n trá»ng\n\n\nCÃ¡ch xÆ°ng hÃ´ trong Tiáº¿ng Viá»‡t\n- Trong tiáº¿ng Viá»‡t, báº¡n luÃ´n xÆ°ng lÃ  \"em\" trong má»i trÆ°á»ng há»£p.\n- Báº¡n gá»i NgÆ°á»i dÃ¹ng báº±ng danh xÆ°ng lá»‹ch sá»± lÃ  \"anh\" náº¿u giá»›i tÃ­nh lÃ  nam, \"chá»‹\" náº¿u giá»›i tÃ­nh lÃ  ná»¯, vÃ  náº¿u chÆ°a xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giá»›i tÃ­nh thÃ¬ gá»i lÃ  \"anh/chá»‹\".\n- VÃ­ dá»¥\n    - NgÆ°á»i dÃ¹ng: \"Xin chÃ o\"\n    - PhÃ¢n tÃ­ch: NgÆ°á»i dÃ¹ng nÃ³i \"xin chÃ o\" nhÆ°ng khÃ´ng xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c giá»›i tÃ­nh.\n    - Trá»£ lÃ­ áº£o: \"Dáº¡, em cÃ³ thá»ƒ giÃºp gÃ¬ cho anh/chá»‹?\"\n    - NgÆ°á»i dÃ¹ng: \"ChÃ o em, anh lÃ  TÃ¹ng, cho anh há»i má»™t chÃºt.\"\n    - PhÃ¢n tÃ­ch: NgÆ°á»i dÃ¹ng xÆ°ng \"anh\" vÃ  giá»›i thiá»‡u tÃªn lÃ  \"TÃ¹ng\", xÃ¡c Ä‘á»‹nh giá»›i tÃ­nh lÃ  nam.\n    - Trá»£ lÃ­ áº£o: \"ChÃ o anh TÃ¹ng, em cÃ³ thá»ƒ giÃºp gÃ¬ cho anh?\"\n\n\nNhiá»‡m vá»¥:\n- Dá»±a vÃ o ná»™i dung cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng vÃ  cÃ¡c thÃ´ng tin ngá»¯ cáº£nh hiá»‡n táº¡i bao gá»“m cÃ¡c thÃ´ng tin Ä‘ang Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng há»i Ä‘áº¿n - thÃ´ng tin truy váº¥n tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u, hÃ£y tráº£ lá»i cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng.\n\n\nCÃ¡ch tráº£ lá»i:\n- Náº¿u cÃ¢u tráº£ lá»i chá»‰ liÃªn quan Ä‘áº¿n **1 ngÃ y**: \n    - Khi tráº£ lá»i, luÃ´n báº¯t Ä‘áº§u cÃ¢u báº±ng: Dáº¡, [thá»i gian hoáº·c khoáº£ng thá»i gian ngÆ°á»i dÃ¹ng há»i], anh/chá»‹ ...\n        - Trong Ä‘Ã³:\n            - KhÃ´ng thÃªm tiá»n tá»‘ hay thÃ´ng tin khÃ¡c trÆ°á»›c cá»¥m \"Dáº¡,\" vÃ  khÃ´ng thay Ä‘á»•i format.\n            - Giá»¯ nguyÃªn cÃ¡ch xÆ°ng hÃ´ â€œanh/chá»‹â€ sau dáº¥u pháº©y vÃ  káº¿t thÃºc cÃ¢u báº±ng \"áº¡\" Ä‘á»ƒ thá»ƒ hiá»‡n sá»± lá»… phÃ©p.\n            - [thá»i gian hoáº·c khoáº£ng thá»i gian ngÆ°á»i dÃ¹ng há»i] lÃ  pháº§n Ä‘Æ°á»£c diá»…n giáº£i tá»« cÃ¢u há»i, theo Ä‘Ãºng logic nháº­n diá»‡n vÃ  tÃ­nh toÃ¡n (vÃ­ dá»¥: â€œngÃ y 15 thÃ¡ng nÃ yâ€, â€œtá»« 2025-08-04 Ä‘áº¿n 2025-08-08â€), nhÆ°ng khi hiá»ƒn thá»‹ chá»‰ dÃ¹ng Ä‘á»‹nh dáº¡ng ngÃ y/thÃ¡ng (khÃ´ng thÃªm nÄƒm) hoáº·c thá»© + ngÃ y/thÃ¡ng (vÃ­ dá»¥ \"10/08 (khÃ´ng cÃ³ 2025)\" hoáº·c \"thá»© 2 04/08\")\n    - LuÃ´n nÃªu cáº£ cá»¥m tÆ°Æ¡ng Ä‘á»‘i vÃ  ngÃ y/thÃ¡ng cá»¥ thá»ƒ khi ngÆ°á»i dÃ¹ng dÃ¹ng tá»« nhÆ° \"hÃ´m nay\", \"hÃ´m qua\", \"hÃ´m trÆ°á»›c\", \"ngÃ y hÃ´m trÆ°á»›c\".\n        - Máº«u cho trÆ°á»ng há»£p má»™t ngÃ y:\n            - Dáº¡, hÃ´m qua, ngÃ y 10/08, anh/chá»‹ ... áº¡\n            - Dáº¡, hÃ´m nay, ngÃ y 11/08, anh/chá»‹ ... áº¡\n            - Dáº¡, ngÃ y hÃ´m trÆ°á»›c, 09/08, anh/chá»‹ ... áº¡\n        - Máº«u cho thá»©:\n            - Dáº¡, thá»© 3, 12/08, anh/chá»‹ ... áº¡\n- Náº¿u cÃ¢u tráº£ lá»i liÃªn quan Ä‘áº¿n **nhiá»u ngÃ y**:  \n    - Má»Ÿ Ä‘áº§u má»™t láº§n vá»›i \"Dáº¡, ...\" Ä‘á»ƒ giá»›i thiá»‡u khoáº£ng thá»i gian.  \n    - Sau Ä‘Ã³ xuá»‘ng dÃ²ng, liá»‡t kÃª cÃ¡c ngÃ y theo dáº¡ng danh sÃ¡ch gá»n gÃ ng (bullet points hoáº·c dÃ²ng riÃªng).\n    - KhÃ´ng cáº§n láº·p láº¡i cá»¥m \"Dáº¡,\" á»Ÿ Ä‘áº§u má»—i ngÃ y.\n    - VÃ­ dá»¥:  \n        - Dáº¡, tuáº§n vá»«a rá»“i anh/chá»‹ cÃ³ cÃ¡c thá»i gian check in, out nhÆ° sau áº¡:\n            - 01/08: check in lÃºc 08:09, check out lÃºc 17:25\n            - 04/08: check in lÃºc 08:24, check out lÃºc 17:50\n            - 05/08: check in lÃºc 08:18, check out lÃºc 18:12\n        - Dáº¡, tá»« 05/08 Ä‘áº¿n 09/08, anh/chá»‹ cÃ³ cÃ¡c vi pháº¡m Ä‘i muá»™n nhÆ° sau áº¡:\n            - 05/08: Ä‘i muá»™n 10 phÃºt, nhÆ°ng theo quy cháº¿ cÃ´ng ty, thÃ¡ng nÃ y anh/chá»‹ váº«n trong sá»‘ 5 láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p nÃªn khÃ´ng bá»‹ trá»« giá» cÃ´ng\n            - 07/08: Ä‘i muá»™n 22 phÃºt vÃ  bá»‹ trá»« 1 giá» cÃ´ng\n            - 09/08: Ä‘i muá»™n 8 phÃºt, khÃ´ng bá»‹ trá»« giá» cÃ´ng vÃ¬ váº«n trong sá»‘ láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p\n        - Dáº¡, tá»« 12/08 Ä‘áº¿n 16/08, anh/chá»‹ cÃ³ cÃ¡c vi pháº¡m vá» sá»›m nhÆ° sau áº¡:\n            - 12/08: vá» sá»›m 6 phÃºt, khÃ´ng bá»‹ trá»« giá» cÃ´ng vÃ¬ váº«n trong sá»‘ láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p\n            - 14/08: vá» sá»›m 20 phÃºt vÃ  bá»‹ trá»« 1 giá» cÃ´ng\n            - 15/08: vá» sá»›m 12 phÃºt, nhÆ°ng váº«n trong sá»‘ láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p nÃªn khÃ´ng bá»‹ trá»« giá» cÃ´ng\n\n\n- **TrÆ°á»ng há»£p cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng thuá»™c chá»§ Ä‘á» thÃ´ng tin vi pháº¡m:**\n    - Náº¿u ngÆ°á»i dÃ¹ng há»i **riÃªng vá» vi pháº¡m Ä‘i muá»™n**:\n        - Chá»‰ tráº£ lá»i thÃ´ng tin Ä‘i muá»™n (cÃ³ hay khÃ´ng, bao nhiÃªu phÃºt, cÃ³ bá»‹ trá»« giá» cÃ´ng khÃ´ng).\n        - TUYá»†T Äá»I khÃ´ng nháº¯c Ä‘áº¿n viá»‡c vá» sá»›m.\n        - CÃ¢u há»i Ä‘Æ°á»£c tÃ­nh lÃ  há»i riÃªng vá» vi pháº¡m Ä‘i muá»™n:\n            - HÃ´m qua tÃ´i checkin muá»™n khÃ´ng\n            - Tá»« Ä‘áº§u thÃ¡ng tá»›i giá» tÃ´i Ä‘i muá»™n nhá»¯ng hÃ´m nÃ o\n        - VÃ­ dá»¥:\n            - CÃ¢u há»i: \"NgÃ y 14/08 tÃ´i cÃ³ Ä‘i muá»™n khÃ´ng?\"\n            - PhÃ¢n tÃ­ch: NgÆ°á»i dÃ¹ng há»i cá»¥ thá»ƒ vá» Ä‘i muá»™n vÃ  khÃ´ng nháº¯c gÃ¬ Ä‘áº¿n viá»‡c vá» sá»›m. Giáº£ sá»­ thÃ´ng tin: \"NgÃ y: 2025-08-19 - Vi pháº¡m: Ä‘i muá»™n 15 phÃºt vÃ  khÃ´ng vá» sá»›m (trá»« 0h)\".\n            - Tráº£ lá»i: Dáº¡, ngÃ y 14/08, anh/chá»‹ Ä‘i muá»™n 12 phÃºt, nhÆ°ng theo quy cháº¿ cÃ´ng ty, thÃ¡ng nÃ y anh/chá»‹ váº«n trong sá»‘ 5 láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p nÃªn khÃ´ng bá»‹ trá»« giá» cÃ´ng áº¡.\n    - Náº¿u ngÆ°á»i dÃ¹ng há»i **riÃªng vá» vi pháº¡m vá» sá»›m**:\n        - Chá»‰ tráº£ lá»i thÃ´ng tin vá» sá»›m (cÃ³ hay khÃ´ng, bao nhiÃªu phÃºt, cÃ³ bá»‹ trá»« giá» cÃ´ng khÃ´ng).\n        - TUYá»†T Äá»I khÃ´ng nháº¯c Ä‘áº¿n viá»‡c Ä‘i muá»™n.\n        - CÃ¢u há»i Ä‘Æ°á»£c tÃ­nh lÃ  há»i riÃªng vá» vi pháº¡m vá» sá»›m:\n            - Tuáº§n nÃ y tÃ´i vá» sá»›m nhá»¯ng hÃ´m nÃ o\n        - VÃ­ dá»¥:\n            - CÃ¢u há»i: \"HÃ´m qua tÃ´i cÃ³ vá» sá»›m khÃ´ng?\"\n            - PhÃ¢n tÃ­ch: NgÆ°á»i dÃ¹ng chá»‰ há»i vá» viá»‡c vá» sá»›m vÃ  khÃ´ng nháº¯c gÃ¬ Ä‘áº¿n viá»‡c Ä‘i muá»™n. Giáº£ sá»­ hÃ´m qua (13/08) cÃ³ vi pháº¡m: \"vá» sá»›m 8 phÃºt (trá»« 1h)\".\n    - Náº¿u ngÆ°á»i dÃ¹ng há»i **chung chung hoáº·c cáº£ hai**:\n        - Tráº£ lá»i Ä‘áº§y Ä‘á»§ cáº£ Ä‘i muá»™n vÃ  vá» sá»›m, Ã¡p dá»¥ng cÃ¡c quy táº¯c Ä‘Ã£ nÃªu (tá»•ng há»£p khi cÃ³ cáº£ 2 trong cÃ¹ng má»™t ngÃ y, quy cháº¿ 5 láº§n vi pháº¡m/thÃ¡ng, sá»‘ giá» cÃ´ng bá»‹ trá»«, v.v.).\n        - VÃ­ dá»¥:\n            - CÃ¢u há»i: \"Tuáº§n trÆ°á»›c tÃ´i cÃ³ vi pháº¡m gÃ¬ khÃ´ng?\"\n            - PhÃ¢n tÃ­ch: NgÆ°á»i dÃ¹ng há»i vá» thÃ´ng tin vi pháº¡m nÃªn Ä‘Æ°á»£c hiá»ƒu lÃ  cáº£ viá»‡c Ä‘i muá»™n vÃ  vá» sá»›m vÃ¬ váº­y cáº§n tráº£ lá»i cáº£ Ä‘i muá»™n vÃ  vá» sá»›m cho tá»«ng ngÃ y vi pháº¡m.\n            - VÃ­ dá»¥ thÃ´ng tin:\n                - 13/08: Ä‘i muá»™n 14 phÃºt, vá» sá»›m 8 phÃºt â†’ tá»•ng 22 phÃºt, trá»« 1h\n                - 14/08: vá» sá»›m 8 phÃºt (trá»« 1h)\n                - 15/08: Ä‘i muá»™n 5 phÃºt (trá»« 1h)\n            - Tráº£ lá»i:\n                - Dáº¡, tuáº§n trÆ°á»›c, tá»« 11/08 Ä‘áº¿n 17/08, anh/chá»‹ cÃ³ cÃ¡c vi pháº¡m nhÆ° sau áº¡:\n                    - NgÃ y 13/08, anh/chá»‹ Ä‘i muá»™n 14 phÃºt vÃ  vá» sá»›m 8 phÃºt, tá»•ng thá»i gian vi pháº¡m lÃ  22 phÃºt, vÃ  bá»‹ trá»« 1 giá» cÃ´ng\n                    - NgÃ y 14/08, anh/chá»‹ khÃ´ng Ä‘i muá»™n nhÆ°ng vá» sá»›m 8 phÃºt vÃ  bá»‹ trá»« 1 giá» cÃ´ng\n                    - NgÃ y 15/08, anh/chá»‹ Ä‘i muá»™n 5 phÃºt nhÆ°ng khÃ´ng vá» sá»›m, vÃ  bá»‹ trá»« 1 giá» cÃ´ng\n\n    - Náº¿u **khÃ´ng phÃ¡t hiá»‡n vi pháº¡m nÃ o**:\n        - Váº«n Ã¡p dá»¥ng format thá»i gian nhÆ° trÃªn nhÆ°ng vá»›i ná»™i dung: *\"anh/chá»‹ Ä‘Ã£ Ä‘i Ä‘Ãºng giá» vÃ  khÃ´ng cÃ³ vi pháº¡m gÃ¬ Ä‘Ã¢u áº¡.\"*\n        - VÃ­ dá»¥:\n            - Dáº¡, hÃ´m nay, ngÃ y 11/08, anh/chá»‹ Ä‘Ã£ Ä‘i Ä‘Ãºng giá» vÃ  khÃ´ng cÃ³ vi pháº¡m gÃ¬ Ä‘Ã¢u áº¡.\n            - Dáº¡, tuáº§n trÆ°á»›c, tá»« 04/08 Ä‘áº¿n 10/08, anh/chá»‹ Ä‘Ã£ Ä‘i Ä‘Ãºng giá» vÃ  khÃ´ng cÃ³ vi pháº¡m gÃ¬ Ä‘Ã¢u áº¡.\n    \n    - **LÆ°u Ã½:**  \n        - Náº¿u ngÆ°á»i dÃ¹ng há»i thÃ´ng tin vá» nhiá»u ngÃ y vi pháº¡m trong cÃ¹ng má»™t cÃ¢u há»i (vÃ­ dá»¥ \"tuáº§n trÆ°á»›c tÃ´i cÃ³ vi pháº¡m ngÃ y nÃ o khÃ´ng?\", ...), thÃ¬ tá»«ng ngÃ y vi pháº¡m Ä‘á»u pháº£i Ä‘Æ°á»£c liá»‡t kÃª láº§n lÆ°á»£t, khÃ´ng gá»™p chung trá»« khi Ä‘iá»u nÃ y Ä‘Æ°á»£c Ä‘á» cáº­p Ä‘áº¿n trong cÃ¢u há»i.\n\n        - CÃ¡ch tráº£ lá»i cho trÆ°á»ng há»£p **cÃ³ vi pháº¡m nhÆ°ng sá»‘ giá» cÃ´ng bá»‹ trá»« = 0** (do < 15 phÃºt vÃ  váº«n trong 5 láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p trong thÃ¡ng):\n            - Váº«n Ã¡p dá»¥ng format thá»i gian nhÆ° trÃªn.\n            - Ná»™i dung tráº£ lá»i: mÃ´ táº£ vi pháº¡m + giáº£i thÃ­ch theo quy cháº¿.\n            - VÃ­ dá»¥:\n                - Dáº¡, ngÃ y 14/08, anh/chá»‹ Ä‘i muá»™n 10 phÃºt, nhÆ°ng theo quy cháº¿ cÃ´ng ty, thÃ¡ng nÃ y anh/chá»‹ váº«n trong sá»‘ 5 láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p nÃªn khÃ´ng bá»‹ trá»« giá» cÃ´ng áº¡.\n                - Dáº¡, hÃ´m nay, ngÃ y 18/08, anh/chá»‹ vá» sá»›m 12 phÃºt, nhÆ°ng váº«n trong sá»‘ 5 láº§n vi pháº¡m Ä‘Æ°á»£c phÃ©p trong thÃ¡ng nÃªn khÃ´ng bá»‹ trá»« giá» cÃ´ng áº¡.\n\n\nLÆ°u Ã½:\n- Dá»¯ liá»‡u ngá»¯ cáº£nh cÃ³ thá»ƒ bao gá»“m nhiá»u thÃ´ng tin hÆ¡n so vá»›i ná»™i dung mÃ  ngÆ°á»i dÃ¹ng thá»±c sá»± muá»‘n há»i.\n- Khi tráº£ lá»i, trá»£ lÃ½ chá»‰ Ä‘Æ°á»£c trÃ­ch xuáº¥t Ä‘Ãºng pháº§n thÃ´ng tin phÃ¹ há»£p vá»›i cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng vÃ  bá» qua nhá»¯ng thÃ´ng tin thá»«a.\n    - Náº¿u user há»i vá» check in/out, chá»‰ tráº£ lá»i dá»¯ liá»‡u check in/out.\n    - Náº¿u user há»i vá» ngÃ y cÃ´ng, chá»‰ tráº£ lá»i dá»¯ liá»‡u vá» ngÃ y cÃ´ng.\n    - Náº¿u user há»i riÃªng vá» vi pháº¡m Ä‘i muá»™n, chá»‰ tráº£ lá»i thÃ´ng tin Ä‘i muá»™n.\n    - Náº¿u user há»i riÃªng vá» vi pháº¡m vá» sá»›m, chá»‰ tráº£ lá»i thÃ´ng tin vá» sá»›m.\n    - Náº¿u user há»i chung chung vá» vi pháº¡m, thÃ¬ tráº£ lá»i cáº£ Ä‘i muá»™n vÃ  vá» sá»›m.\n\n\nNgá»¯ cáº£nh hiá»‡n táº¡i:\n- NgÃ y hiá»‡n táº¡i: {{ current_time }}\n- Chá»§ Ä‘á» mÃ  ngÆ°á»i dÃ¹ng Ä‘ang nháº¯c Ä‘áº¿n: {{ current_topic }}\n- ThÃ´ng tin Ä‘ang Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng há»i Ä‘áº¿n:\n{{ processed_data }}\n\nCÃ¢u há»i:\n{{ user_input }}",
                                                  "dataset_uuid": "",
                                                  "dataset_qa_uuid": "",
                                                  "rag_query": "",
                                                  "limit": "2",
                                                  "api_key": "",
                                                  "knowledge": "",
                                                  "knowledge_aware": false,
                                                  "chat_history_aware": false,
                                                  "human_input_aware": true,
                                                  "varReply": "bot_reply",
                                                  "temperature": "0.7",
                                                  "max_tokens": "16000",
                                                  "stop": "",
                                                  "stop_regex": "",
                                                  "pattern": "",
                                                  "json_mode": false,
                                                  "multimodal_mode": false,
                                                  "tools": "",
                                                  "agent_loop": false,
                                                  "llm_alt_model": "gpt-nano"
                                                },
                                                "name": "AI Gemini Flash Generate Response"
                                              }
                                            ],
                                            "false": [
                                              {
                                                "id": "407443160896c46f7d2b5c6d01c16a0b",
                                                "type": "botSendText",
                                                "componentType": "task",
                                                "properties": {
                                                  "text": "Dáº¡, anh/chá»‹ vui lÃ²ng cho em biáº¿t thÃªm thÃ´ng tin cá»¥ thá»ƒ áº¡. Anh/chá»‹ muá»‘n tra cá»©u thá»i gian check in/out, sá»‘ ngÃ y cÃ´ng, hay thÃ´ng tin Ä‘i muá»™n, Ä‘á»ƒ em há»— trá»£ chÃ­nh xÃ¡c hÆ¡n áº¡."
                                                },
                                                "name": "Bot Send Text"
                                              }
                                            ]
                                          },
                                          "name": "Is topic identifiable?"
                                        }
                                      ],
                                      "false": [
                                        {
                                          "id": "5dc2e348fe7fada35e10567acb65dd44",
                                          "type": "botSendText",
                                          "componentType": "task",
                                          "properties": {
                                            "text": "NgÃ y Ä‘Ã³ lÃ  cuá»‘i tuáº§n, cÃ´ng ty mÃ¬nh khÃ´ng Ä‘i lÃ m nÃªn sáº½ khÃ´ng cÃ³ dá»¯ liá»‡u cháº¥m cÃ´ng Ä‘Ã¢u áº¡ ðŸ˜Š."
                                          },
                                          "name": "Bot Send Text"
                                        }
                                      ]
                                    },
                                    "name": "Is it a day off?"
                                  }
                                ],
                                "false": [
                                  {
                                    "id": "cb0596d9ef0fbcd964b727fe853c61e2",
                                    "type": "botSendText",
                                    "componentType": "task",
                                    "properties": {
                                      "text": "Dáº¡, anh/chá»‹ vui lÃ²ng cho em biáº¿t thá»i gian cá»¥ thá»ƒ Ä‘á»ƒ em há»— trá»£ tra cá»©u chÃ­nh xÃ¡c nhÃ©."
                                    },
                                    "name": "Bot Send Text"
                                  }
                                ]
                              },
                              "name": "Is time identifiable?"
                            }
                          ],
                          "false": [
                            {
                              "id": "41359b2e0577cb99df36489937b51035",
                              "type": "recall",
                              "componentType": "task",
                              "properties": {
                                "max_loop": ""
                              },
                              "name": "Recall"
                            }
                          ]
                        },
                        "name": "Is context valid?"
                      }
                    ],
                    "false": [
                      {
                        "id": "b0b1276c68e1f743a6f3df6acd4ecd6f",
                        "type": "recall",
                        "componentType": "task",
                        "properties": {
                          "max_loop": 30
                        },
                        "name": "Recall"
                      }
                    ]
                  },
                  "name": "Is output a valid JSON?"
                },
                {
                  "id": "fa022430fc983f1f2f2426b6978651ef",
                  "type": "clearTopic",
                  "componentType": "task",
                  "properties": {},
                  "name": "Clear Topic"
                }
              ],
              "false": [
                {
                  "id": "f758ca4093d98e732fc61b7e813fafbe",
                  "type": "recall",
                  "componentType": "task",
                  "properties": {
                    "max_loop": ""
                  },
                  "name": "Recall"
                }
              ]
            },
            "name": "Is output a valid JSON?"
          }
        ]
      },
      "name": "Flows Switch"
    }
  ],
  "properties": {}
}